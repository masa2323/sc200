概要  
\-  
  
Contoso Ltd. という会社には、北米各地に本社と 5 つの支社があります。本社はシアトルにあります。支社は、トロント、マイアミ、ヒューストン、ロサンゼルス、バンクーバーにあります。Contoso には、ニューヨークとサンフランシスコにオフィスがある Fabrikam, Ltd. という子会社があります。  
  
既存の環境  
\-  
  
エンド ユーザー環境  
\-  
  
Contoso のすべてのユーザーは、Windows 11 デバイスを使用します。各ユーザーには、Microsoft 365 のライセンスが付与されています。さらに、iOS デバイスが Contoso の営業チームのメンバーに配布されています。  
  
クラウドとハイブリッド インフラストラクチャ  
  
Contoso のすべてのアプリケーションは、Azure に展開されています。Microsoft Defender for Cloud Apps を有効にします。Contoso と Fabrikam には、異なる Microsoft Entra テナントがあります。 Fabrikamは最近Azureサブスクリプションを購入し、サポートされているすべてのリソースタイプに対してMicrosoft Defender for Cloudを有効にしました。  
  
現在の問題  
\-  
  
Contoso 社のセキュリティ チームは、大量のサイバーセキュリティ アラートを受信して​​います。セキュリティ チームは、どのサイバーセキュリティ アラートが正当な脅威で、どれがそうでないかを識別するのに多くの時間を費やしています。Contoso社の営業チームは、iOS デバイスのみを使用しています。営業チームのメンバーは、さまざまなサードパーティ ツールを使用して顧客とファイルを交換しています。過去に、営業チームはデバイスがフィッシング攻撃を受けたことがあります。Contoso 社のマーケティング チームは、外部ベンダーとのコラボレーション用に複数の Microsoft SharePoint Online サイトを所有しています。マーケティング チームは、ベンダーがマルウェアを含むファイルをアップロードするインシデントを何度か経験しています。Contoso 社の経営陣は、セキュリティ侵害を疑っています。経営陣は、Microsoft Defender for Cloud Apps で保護されたアプリケーションのデータ アクセス、ダウンロード、削除など、過去 48 時間以内に 5 件を超えるアクティビティがあったファイルを特定するよう依頼しています。  
  
要件  
\-  
  
計画されている変更  
\-  
  
Contoso 社は、両社のセキュリティ運用を統合し、すべてのセキュリティ運用を一元管理する予定です。

技術要件  
\-  
  
Contoso 社では、次の技術要件を特定しています。
• Microsoft Sentinel を使用して、環境に対するアクティブな攻撃を迅速に修復することで、組織のリスクを軽減します。
• Contoso と Fabrikam の Microsoft Entra テナント間でデータを相関させる Microsoft Sentinel クエリを実装します。
• 外部および内部の脅威が発生した場合に Contoso の Microsoft Defender for Key Vault アラートを修復する手順を開発します。ソリューションは、Key Vault コンテンツへの正当なアクセス試行への影響を最小限に抑える必要があります。
• 特定の国から Azure リソースへの初回サインインに失敗したユーザーのすべてのケースを特定します。ジュニア セキュリティ管理者から次の不完全なクエリが提供されます。
BehaviorAnalytics \- | where ActivityType == "FailedLogOn" | where \_\_\_\_\_\_\_\_ == True 

### **問題1**
Contoso の Microsoft Defender for Cloud アラートに対する修復アクションを推奨する必要があります。それぞれの脅威に対して何を推奨しますか。 回答するには、回答領域で適切なオプションを選択します。
注: 正しい選択ごとに 1 ポイントが付与されます。  
  
![](https://img.examtopics.com/sc-200/image460.png)

**解説:**
技術要件として「正当なアクセス試行への影響を最小限に抑える」ことが求められています。

#### 内部脅威 (Internal threat)

内部のユーザーや管理者による誤操作や悪意のある削除・変更を防ぐには、**リソースロック (Resource locks)** が最も効果的です。

- **なぜこれか:** `ReadOnly` または `CanNotDelete` ロックを適用することで、権限を持つユーザーであっても誤って Key Vault を削除することを防げます。
- **他が不適切な理由:** アクセスポリシーの変更や新規作成は、既存のアプリケーションやユーザーの正当なアクセスを遮断（ダウンタイムの発生）させるリスクが高く、要件である「影響を最小限に抑える」に反します。
    
#### 外部脅威 (External threat)

外部からの不審なアクセスが検知された場合、ネットワークレベルでの隔離が必要です。

- **なぜこれか:** **Key Vault ファイアウォール設定**を構成して、信頼できる特定のネットワークまたはプライベートエンドポイントからのみアクセスを許可するように制限することで、外部の攻撃者からのアクセスを即座にブロックできます。
- **他が不適切な理由:** NSG (ネットワークセキュリティグループ) は一般的にサブネットや VM レベルで動作しますが、Key Vault 自体のアクセス制御としては、組み込みの「ファイアウォールと仮想ネットワーク」設定を操作するのが直接的かつ推奨される修復手順です。

### **問題2**
Microsoft Defender for Endpoint を使用することで、どのチームの問題を解決できますか？  

- A. エグゼクティブ
- B. 販売
- C. マーケティング

解説
各チームの課題と対応ソリューション

|**チーム**|**主な課題**|**最適なソリューション**|
|---|---|---|
|**B. 販売**|**iOS デバイス**を使用しており、過去に**フィッシング攻撃**を受けた。|**Microsoft Defender for Endpoint**|
|**C. マーケティング**|SharePoint Online に外部ベンダーが**マルウェア**を含むファイルをアップロードする。|**Microsoft Defender for Office 365**|
|**A. エグゼクティブ**|クラウドアプリ（MDCA）上での大量のファイル操作（ダウンロード・削除等）を特定したい。|**Microsoft Defender for Cloud Apps**|

---
### なぜ「販売チーム」なのか？

Microsoft Defender for Endpoint は、Windows だけでなく **iOS や Android などのモバイルデバイス**もサポートしています。

- **フィッシング対策:** MDE のモバイル版には「Web 保護」機能が含まれており、安全でないサイトへのアクセスをブロックしたり、フィッシングメール内の悪意のあるリンクからユーザーを保護したりできます。
- **エンドポイントの保護:** 販売チームが iOS デバイスのみを使用しているという背景に対し、デバイス自体を守る EDR（Endpoint Detection and Response）としての機能を提供します。
    
### 他の選択肢が正しくない理由

- **マーケティングチーム (C):** SharePoint Online 上のファイル検査（マルウェア検知）は、**Microsoft Defender for Office 365** の「セーフ添付ファイル (Safe Attachments) for SharePoint, OneDrive, and Microsoft Teams」機能が担当します。
- **エグゼクティブ (A):** クラウドサービス内のアクティビティ監視やファイル操作の異常検知は、**Microsoft Defender for Cloud Apps (MDCA)** のポリシーで対応する領域です。

### **問題3**
Microsoft Defender for Office 365 を使用することで解決できるチームの問題はどれですか？  

- A. エグゼクティブ
- B. マーケティング
- C. セキュリティ
- D. 販売

解説
SharePoint、One Drive、Microsoft Teams向けのSafe Attachmentsは、Microsoft Defender for Office 365の機能です。

### **問題4**
Fabrikam の Azure Defender アラートに対する修復アクションを推奨する必要があります。  
それぞれの脅威に対して何を推奨すべきでしょうか？回答するには、回答エリアで適切な選択肢を選択してください。  
注：正解は1つにつき1点です。

![[Pasted image 20260210011527.png]]

**内部脅威 (Internal threat) への対応:**
- 内部脅威は、組織内部からの不正アクセスや誤操作を指します
- ドキュメントでは、アクセス制御の強化として「RBACによる最小権限の原則」「アクセスポリシーの見直し」が推奨されています
- リソースロックは、重要なリソースの誤削除や不正な変更を防ぐための措置として推奨されています

**外部脅威 (External threat) への対応:**
- 外部脅威は、インターネット経由の攻撃者からのアクセス試行を指します
- ドキュメントでは、ネットワークセキュリティの強化が重要とされています
- Key Vaultファイアウォールの設定により、パブリックIPアドレスからのアクセスを制限
- ネットワークセキュリティグループ(NSG)の変更は、Key Vault自体ではなくVNet/サブネットレベルでの制御

**解答:**
- **Internal threat (内部脅威)**: **Modify the access policy settings for the key vault**
    - 内部からの不正アクセスに対しては、アクセスポリシー(またはRBAC)の見直しと適切な権限設定が最も効果的です
- **External threat (外部脅威)**: **Modify the Key Vault firewall settings**
    - 外部からの攻撃に対しては、Key Vaultファイアウォールを有効化して、信頼できるIPアドレスやVNetからのみアクセスを許可することが推奨されます

### **問題5**
Azure仮想マシンの技術要件を満たすソリューションを推奨する必要があります。  
推奨事項には何を含めるべきですか？  

- A. ジャストインタイム（JIT）アクセス
- B. Microsoft Defender for Cloud
- C. Azure ファイアウォール
- D. Azure アプリケーション ゲートウェイ
#### **A. ジャストインタイム（JIT）アクセス**
- **機能**: Azure VMへのネットワークアクセスを制限し、必要な時だけ、必要なポートに、必要な期間だけアクセスを許可
- **メリット**: ブルートフォース攻撃の攻撃面を最小化し、VHへの不正アクセスを防ぐ
- **前提条件**: **Microsoft Defender for Servers Plan 2が必要**
- **関連性**: ✅ ブルートフォース攻撃に対する**予防策および検出機能**として効果的

#### **B. Azure Defender (Microsoft Defender for Cloud)**
- **機能**: 脅威の検出、アラート生成、セキュリティ監視
- **メリット**: ブルートフォース攻撃を検出し、アラートを生成
- **関連性**: ✅ **アラート受信の要件を直接満たす**

#### **C. Azure Firewall**
- **機能**: ネットワークレベルのファイアウォール
- **関連性**: ❌ ブルートフォース攻撃の**検出やアラート機能は提供しない**

#### **D. Azure Application Gateway**
- **機能**: レイヤー7のロードバランサー
- **関連性**: ❌ ブルートフォース攻撃の**検出やアラート機能は提供しない**

## 解答
Microsoft Learn MCP Serverのドキュメントによると、**ブルートフォース攻撃に対するアラートを受信する**という技術要件を満たすには、以下の2つが必要です:

### **正解: A と B の両方**

**理由:**
1. **B. Azure Defender (Microsoft Defender for Cloud)** - **必須**
    - ブルートフォース攻撃を**検出**し、**アラートを生成**する
    - 技術要件「アラートを受信する」を直接満たす
2. **A. ジャストインタイム（JIT）アクセス** - **推奨（Bとセット）**
    - JIT機能は**Microsoft Defender for Servers Plan 2の機能**
    - ブルートフォース攻撃から保護し、攻撃面を最小化
    - ドキュメントでは、JITとDefender for Cloudは常にセットで推奨されている

### **問題6**
技術要件を満たすには、失敗したサインインのクエリを完了する必要があります。WHERE  
句を完了するための列名はどこで確認できますか？  

- A. Azure Security Center のセキュリティ アラート
- B. Azureのアクティビティログ
- C. Azureアドバイザー
- D. Log Analytics ワークスペースのクエリ ウィンドウ

### 正解: **D. Log Analytics ワークスペースのクエリ ウィンドウ**

### 各選択肢の評価

#### **A. Azure Security Center のセキュリティ アラート**
- アラートは脅威検出の結果を表示
- テーブルスキーマや列名の確認には不適切
- ❌ 不正解

#### **B. Azure のアクティビティログ**
- 管理操作の監査ログ
- テーブルスキーマの確認には使用しない
- ❌ 不正解

#### **C. Azure アドバイザー**#
- ベストプラクティスの推奨事項を提供
- テーブルスキーマの確認機能はない
- ❌ 不正解

#### **D. Log Analytics ワークスペースのクエリ ウィンドウ**
- Microsoft Learn MCP Serverのドキュメントによると:
    - **Tablesタブ**: 「テーブルを展開してスキーマを表示」できる
    - **テーブルの列を表示**: テーブル名をホバーまたは展開することで列名と型を確認できる
    - **IntelliSense機能**: クエリウィンドウでテーブル名や列名の入力支援が提供される
- ✅ **正解**


### **問題7**
技術要件を満たすには、アクティブな攻撃を修復する必要があります。  
ソリューションには何を含めるべきですか？  

- A. Azure Automation ランブック
- B. Azure ロジック アプリ
- C. Azure 関数
- D. Azure Sentinel ライブストリーム

### 正解: **B. Azure Logic Apps（ロジック アプリ）**

### 問題の分析

**技術要件:** 「Azure Sentinelを使用して、環境に対するアクティブな攻撃を迅速に修復することで、組織のリスクを軽減する」

### 各選択肢の評価

#### **A. Azure Automation ランブック**
- **機能**: PowerShellやPythonスクリプトを自動実行
- **用途**: インフラストラクチャの自動化、定期的なメンテナンスタスク
- **Azure Sentinelとの統合**: 直接的な統合機能なし
- ❌ 不正解

#### **B. Azure Logic Apps（ロジック アプリ）**
- Microsoft Learn MCP Serverのドキュメントから:
    - **「Playbooksはワークフローを基に構築されており、Azure Logic Appsで作成される」**
    - **「プレイブックは自動的に脅威への対応を実行し、修復アクションを自動化・オーケストレーション」**
    - **「アカウントとマシンが侵害された場合、プレイブックは自動的にマシンをネットワークから隔離し、SOCチームに通知する前にアカウントをブロックできる」**
- ✅ **正解**

#### **C. Azure Functions（Azure 関数）**#
- **機能**: サーバーレスコンピューティング
- **用途**: イベント駆動型の軽量処理
- **Azure Sentinelとの統合**: プレイブックの主要技術ではない
- ❌ 不正解

#### **D. Azure Sentinel ライブストリーム**#
- **機能**: リアルタイムでのデータストリーミング
- **用途**: データの監視と表示
- **修復機能**: 自動修復機能は提供しない
- ❌ 不正解

### **問題8**
経営陣の問題を調査するために、高度なハンティングクエリを作成する必要があります。  
クエリをどのように完了すればよいですか？回答するには、回答エリアで適切な選択肢を選択してください。  
注：正しい選択肢ごとに1ポイント獲得できます。
![[Pasted image 20260210012700.png]]

**1. テーブル選択（最初のドロップダウン）:**
- **正解: `CloudAppEvents`**
- 理由: Microsoft Cloud App Security（現在のMicrosoft Defender for Cloud Apps）のイベントデータは`CloudAppEvents`テーブルに格納されます
- `DeviceFileEvents`と`DeviceProcessEvents`はエンドポイント関連のテーブルで、クラウドアプリのアクティビティには使用されません

**2. 集計関数（2番目のドロップダウン）:**
- **正解: `count()`**
- 理由: ファイルごとのアクティビティ数をカウントする必要があるため
- `avg()`: 平均値の計算（不適切）
- `sum()`: 合計値の計算（カウントには不適切）
- `count()`: イベントの数をカウント（✓ 正しい）

### **問題9**
技術要件を満たすために、Contoso と Fabrikam に Azure Sentinel クエリを実装する必要があります。  
ソリューションには何を含める必要がありますか？回答するには、回答エリアで適切な選択肢を選択してください。  
注：正しい選択肢は1つにつき1点です。

#### **1. Minimum number of Log Analytics workspaces required in the Azure subscription of Fabrikam:**

**正解: `2`**

**理由:** Microsoft Learn MCP Serverのドキュメントから:

> **"Microsoft Sentinel supports data collection from Microsoft and Azure SaaS resources only within its own Microsoft Entra tenant boundary. Therefore, each Microsoft Entra tenant requires a separate workspace."**

> **"We recommend that you create at least one workspace for each Microsoft Entra tenant to support built-in, service to service data connectors that work only within their own Microsoft Entra tenant."**

- **Contosoテナント**: 最低1つのLog Analyticsワークスペースが必要
- **Fabrikamテナント**: 最低1つのLog Analyticsワークスペースが必要

問題は「FabrikamのAzureサブスクリプションに必要なワークスペースの最小数」を聞いているので、Fabrikamには**最低1つ**必要です。
しかし、選択肢を見ると、全体で必要な最小数を聞いている可能性があります。その場合は**2**（各テナントに1つずつ）が正解です。

#### **2. Query element required to correlate data between tenants:**

**正解: `workspace`**

**理由:** Microsoft Learn MCP Serverのドキュメントから:

> **"Use the `workspace( )` expression, with the workspace identifier as the argument, to refer to a table in a different workspace."**

> **"Use the union operator alongside the `workspace( )` expression to apply a query across tables in multiple workspaces."**

クロステナントでデータを相関させるクエリの例:

kql

```kql
union 
  workspace("/subscriptions/<subscriptionId>/resourcegroups/<resourceGroupName>/providers/microsoft.OperationalInsights/workspaces/<ContosoWorkspace>").SecurityEvent,
  workspace("/subscriptions/<subscriptionId>/resourcegroups/<resourceGroupName>/providers/microsoft.OperationalInsights/workspaces/<FabrikamWorkspace>").SecurityEvent
| where TimeGenerated > ago(1d)
```

- **`extend`**: 列を追加（不適切）
- **`project`**: 列を選択（不適切）
- **`workspace`**: 別のワークスペースを参照（✓ 正しい