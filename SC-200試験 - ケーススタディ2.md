概要  
\-  
Litware Inc. は再生可能エネルギー会社です。  
  
Litware には、ボストンとシアトルにオフィスがあります。 Litware には、米国全土にリモート ユーザーもいます。 クラウド リソースなどの Litware リソースにアクセスするために、リモート ユーザーはどちらかのオフィスに VPN 接続を確立します。  
  
既存の環境  
\-  
  
ID 環境  
\-  
  
ネットワークには、litware.com という名前の Azure Active Directory (Azure AD) テナントに同期する litware.com という名前の Active Directory フォレストが含まれています。  
  
Microsoft 365 環境  
\-  
  
Litware には、litware.com Azure AD テナントにリンクされた Microsoft 365 E5 サブスクリプションがあります。 Microsoft Defender for Endpoint は、Windows 10 を実行するすべてのコンピューターに展開されています  
  
Azure環境  
\-  
  
Litwareは、litware.com Azure ADテナントにリンクされたAzureサブスクリプションを所有しています。このサブスクリプションには、次の表に示すように、米国東部Azureリージョンのリソースが含まれています。  
  
![](https://img.examtopics.com/sc-200/image215.png)  
  
ネットワーク環境  
\-  
  
Litware の各オフィスはインターネットに直接接続し、Azure サブスクリプションの仮想ネットワークへのサイト間 VPN 接続があります。  
  
オンプレミス環境  
\-  
  
オンプレミス ネットワークには、次の表に示すコンピューターが含まれます。  
  
![](https://img.examtopics.com/sc-200/image216.png)  
  
現在の問題  
\-  
  
ユーザーが両方のオフィスに同時に接続すると、Microsoft Defender for Cloud Apps で誤検知アラートが頻繁に生成されます。  
  
計画されている変更と要件  
  
計画されている変更  
\-  
  
Litware では、次の変更を実装する予定です。  
  
• Azure サブスクリプションに Microsoft Sentinel を作成して構成します。  
• Azure AD テスト ユーザー アカウントを使用して、Microsoft Sentinel の機能を検証します。  
  
ビジネス要件  
\-  
  
Litware では、次のビジネス要件を特定しています。  
  
• 可能な限り、最小権限の原則を使用する必要があります。  
• 他のすべての要件が満たされている限り、コストを最小限に抑える必要があります。  
• Log Analytics によって収集されたログは、ユーザー アクティビティの完全な監査証跡を提供する必要があります。  
• すべてのドメイン コントローラーは、Microsoft Defender for Identity を使用して保護する必要があります。  
  
- Azure Information Protection の要件  
  
機密ラベルが付いていて Windows 10 コンピューターに保存されているすべてのファイルは、Azure Information Protection – データ検出ダッシュボードから利用できる必要があります。  
  
- Microsoft Defender for Endpoint の要件  
  
Microsoft Defender for Cloud Apps のすべての未承認アプリは、Microsoft Defender for Endpoint を使用して Windows 10 コンピューター上でブロックされる必要があります。  
  
- Microsoft Defender for Cloud Apps のセキュリティ要件  
  
Microsoft Defender for Cloud Apps は、テナント レベルのデータに基づいてユーザー接続が異常かどうかを識別する必要があります。  
  
- Microsoft Defender for Cloud の要件  
  
すべてのサーバーが、同じ Log Analytics ワークスペースにログを送信する必要があります。  
  
- Microsoft Sentinel の要件  
  
Litware は、次の Microsoft Sentinel の要件を満たしている必要があります。  
  
• Microsoft Sentinel と Microsoft Defender for Cloud Apps を統合します。  
• admin1 という名前のユーザーが Microsoft Sentinel プレイブックを構成できるようにします。  
• カスタム クエリに基づいて Microsoft Sentinel 分析ルールを作成します。ルールは、プレイブックの実行を自動的に開始する必要があります。  
• 特定の IP アドレスからのデータ アクセスを表すイベントにメモを追加して、ハンティング中に調査グラフ内を移動するときに IP アドレスを参照できるようにします。  
• Azure AD テスト ユーザー アカウントによる Microsoft Office 365 への受信アクセスが検出されるとアラートを生成するテスト ルールを作成します。ルールによって生成されたアラートは、テスト ユーザー アカウントごとに 1 つのインシデントとして、個別のインシデントにグループ化する必要があります。  
  
### **問題1**
ビジネス要件を満たすようにDC1を構成する必要があります。  
  
どの3つのアクションを順番に実行する必要がありますか？回答するには、アクションリストから適切なアクションを回答エリアに移動し、正しい順序に並べ替えてください。  
  
![](https://img.examtopics.com/sc-200/image217.png)

**解説:**
Microsoft Defender for Identity (MDI) を導入し、ドメインコントローラー（DC1）を保護するには、以下のプロセスが必要です。

1. MDI インスタンスの作成 (Create an instance of Microsoft Defender for Identity)

まず最初に、Microsoft Defender ポータルで MDI のサービス（インスタンス）を有効にする必要があります。これが作成されていないと、センサーのダウンロードや設定を行うことができません。

2. グローバル管理者資格情報の提供 (Provide global administrator credentials...)

MDI インスタンスの作成や、Azure AD（Entra ID）テナントとの連携設定、およびセンサーのセットアップファイルをダウンロードする権限を得るために、**グローバル管理者 (Global Administrator)** の権限が必要になります。

- _補足:_ 「Domain Administrator」の資格情報は、センサーが Active Directory 内の情報を読み取るための「ディレクトリサービスアカウント」として後ほど設定しますが、初期セットアップの 3 ステップとしてはグローバル管理者の提供が優先されます。
    

3. センサーのインストール (Install the sensor on DC1)

DC1 は Windows Server 2019 を実行する**ドメインコントローラーそのもの**であるため、**「センサー (MDI Sensor)」**を直接インストールするのが最適です。

- **なぜ「standalone sensor」ではないのか？**: スタンドアロンセンサーは、ドメインコントローラーに直接インストールできない場合や、ポートミラーリングを使用してネットワークトラフィックを監視する場合に使用するものです。DC1 のように直接インストール可能な環境では、リソース効率が良く管理も容易な通常のセンサーを使用します。
    
構成のポイント

- **最小権限の原則:** 初期設定にはグローバル管理者が必要ですが、運用フェーズでの AD 参照には専用のサービスアカウント（GMSA など）を使用することが推奨されます。
- **直接接続:** DC1 はインターネットに直接接続されているため、追加のプロキシ設定なしで MDI クラウドサービスと通信が可能です。

### **問題2**
Azure Information Protectionの要件を実装する必要があります。  
最初に何を構成する必要がありますか？  

- A. Microsoft Defender セキュリティ センターのデバイス正常性とコンプライアンス レポートの設定
- B. Azure ポータルからの Azure Information Protection のスキャナー クラスター
- C. Azure ポータルからの Azure Information Protection のコンテンツ スキャン ジョブ
- D. Microsoft Defender セキュリティ センターの設定から高度な機能を選択する

この問題の正解は **D. Microsoft Defender セキュリティ センターの設定から高度な機能を選択する** です。

---
### 解説

この問題のポイントは、**「Windows 10 コンピューター上にあるラベル付きファイルの情報を、いかにして Azure Information Protection (AIP) のダッシュボードに反映させるか」**という点です。

#### 1. なぜ「D」が正解なのか
Windows 10 などのエンドポイント デバイス上のデータを AIP のデータ検出ダッシュボードで確認するには、**Microsoft Defender for Endpoint (MDE) と AIP (現在の Microsoft Purview) の連携**を有効にする必要があります。

- **設定箇所:** Microsoft Defender セキュリティ センター（現在の Microsoft Defender ポータル）の [設定] > [エンドポイント] > [高度な機能] に進みます。
- **アクション:** ここにある **「Microsoft 情報保護 (Microsoft Information Protection)」** のトグルを **オン** にします。
- **結果:** これにより、MDE がデバイス上のラベル付けされたファイルをスキャンし、そのメタデータを AIP/Purview の管理コンソールに送信できるようになります。
    
#### 2. 他の選択肢が誤りである理由
- **B および C (AIP スキャナー):** AIP スキャナーは、主に**オンプレミスのファイル サーバー**や **SharePoint Server** 上のファイルをスキャンするためのものです。個々のユーザーが利用する Windows 10 コンピューターを対象とする場合は、スキャナーではなく MDE との連携を使用するのが一般的であり、要件に合いません。
- **A (デバイス正常性とコンプライアンス レポート):** これはデバイス自体のセキュリティ状態を報告するものであり、ファイル内のセキュリティ ラベルを検出して AIP ダッシュボードに送るための設定ではありません。
    
---
### まとめ

Windows 10 デバイス上のラベル情報を AIP で可視化するための「最初のステップ」は、**エンドポイント保護（MDE）側で情報保護との連携機能を有効化すること**です。

### **問題3**
Cloud App Securityの要件を満たし、報告された問題を解決するには、異常検出ポリシー設定を変更する必要があります。  
どのポリシーを変更する必要がありますか？  

- A. 疑わしいIPアドレスからのアクティビティ
- B. 匿名IPアドレスからのアクティビティ
- C. 不可能な旅行
- D. 危険なサインイン

正解は **C. 不可能な旅行 (Impossible travel)** です。

---
### 解説
この問題の鍵は、ユーザーが**「ボストンとシアトルの両方のオフィスに同時に（または短時間で）VPN接続する」**という行動が、セキュリティシステムにどう検知されるかという点にあります。

#### 1. なぜ「C」が正解なのか
**不可能な旅行 (Impossible travel)** ポリシーは、2 つの異なる場所から短時間（物理的な移動が不可能な時間内）に同じユーザーのアクティビティが検出された場合にアラートを出します。

- **現象:** ユーザーがボストンオフィスの VPN に繋ぎながら、シアトルオフィスのリソースにもアクセスしようとしてシアトルの VPN を利用すると、Microsoft Defender for Cloud Apps (旧名: MCAS) は「このユーザーは今ボストンにいるのか？シアトルにいるのか？こんな短時間で移動できるはずがない！」と判断し、異常として検知します。
- **誤検知の理由:** これが業務上正当な VPN 接続であっても、システム側で「オフィスの IP アドレス」として正しく認識・除外設定されていないと、不可能な旅行としてフラグが立ってしまいます。
    
#### 2. 問題を解決するための設定変更
この誤検知を解決するには、単にポリシーをオフにするのではなく、以下の設定を行うのが一般的です。

1. **IP アドレス範囲の定義:** ボストンとシアトルの各オフィスのグローバル IP アドレスを、Defender for Cloud Apps の設定で **「企業 (Corporate)」** または **「信頼済み (Trusted)」** として登録します。
2. **ポリシーの微調整:** 「不可能な旅行」ポリシーの設定で、**「信頼済み IP アドレスからのアクティビティを無視する」** オプションを有効にします。
    
#### 3. 他の選択肢が不適切な理由
- **A. 疑わしいIPアドレス / B. 匿名IPアドレス:** これらは Tor ネットワークや既知の悪意ある IP からのアクセスを検知するものであり、今回のような「自社拠点間の VPN 利用による場所の不整合」とは直接関係ありません。
- **D. 危険なサインイン:** これは主に Azure AD Identity Protection の機能であり、Cloud App Security の「異常検出ポリシー」の枠組みにおける直接的な名称ではありません。
    
---
### まとめ
「2 つの拠点に同時に接続してアラートが出る」という記述があれば、それは **物理的な移動速度の矛盾** を突く「不可能な旅行」のアラートだと特定できます。

### **問題4**
ビジネス要件を満たすようにDC1を構成する必要があります。  
どの4つのアクションを順番に実行する必要がありますか？回答するには、アクションリストから適切なアクションを回答エリアに移動し、正しい順序に並べます。
![[Pasted image 20260210010930.png]]

**正しい順序:**
1. **Create an instance of Microsoft Defender for Identity.**
    - まず、Azure ADテナントでDefender for Identityのインスタンスを作成する必要があります
2. **Provide global administrator credentials to the litware.com Azure AD tenant.**
    - Defender for IdentityインスタンスをAzure ADテナントに接続するため、グローバル管理者の認証情報が必要です
3. **Provide domain administrator credentials to the litware.com Active Directory domain.**
    - センサーがオンプレミスのActive Directoryドメインにアクセスするため、ドメイン管理者の認証情報が必要です
4. **Install the sensor on DC1.**
    - 最後に、ドメインコントローラーDC1に実際のセンサーをインストールします

**重要なポイント:**
- 「Install the standalone sensor on DC1」は選択しません。スタンドアロンセンサーは、ドメインコントローラーに直接インストールできない場合（ポートミラーリングを使用する場合など）に使用されますが、DC1には直接センサーをインストールできるため、通常のセンサーを使用します
- この順序により、最小権限の原則を守りながら、適切な認証と構成が行われます

### **問題5**
Azure Defenderの要件とビジネス要件を満たすには、Azure Defenderを実装する必要があります。  
ソリューションには何を含めるべきですか？回答するには、回答エリアで適切な選択肢を選択してください。  
注：正しい選択ごとに1点が加算されます。
![[Pasted image 20260210011240.png]]

問題を整理すると：
- **Azure Defenderの要件**: すべてのサーバーが同じLog Analyticsワークスペースにログを送信する必要がある
- **ビジネス要件**: Log Analyticsによって収集されたログは、ユーザーアクティビティの完全な監査証跡を提供する必要がある

環境には以下のリソースがあります：
- LA1: 既存のLog Analyticsワークスペース（米国東部）
- VM1: Windows Server 2019
- VM2: Ubuntu 18.04 LTS
- DC1: Windows Server 2019（ドメインコントローラー）
- CLIENT1: Windows 10

Azure DefenderとLog Analyticsワークスペースの構成について検索します。

要件に基づいた回答：
**Log Analytics workspace to use: LA1**

理由：
- Azure Defenderの要件で「すべてのサーバーが**同じLog Analyticsワークスペース**にログを送信する必要がある」と明記されています
- LA1は既存のワークスペースで、すでに米国東部リージョンに存在しています
- ビジネス要件で「コストを最小限に抑える必要がある」とあるため、新しいワークスペースを作成するのではなく、既存のLA1を使用することでコストを削減できます
- 「Default workspace created by Azure Security Center」を使用すると、サーバーごとに異なるワークスペースになる可能性があり、「同じワークスペース」という要件を満たせません

**Windows security events to collect: Common**

理由：
- ビジネス要件で「Log Analyticsによって収集されたログは、ユーザーアクティビティの**完全な監査証跡**を提供する必要がある」と記載されています
- **Common**: 一般的なセキュリティイベントセットを収集し、完全な監査証跡を提供します。これには認証イベント、アカウント管理、プロセス作成などが含まれます
- **Minimal**: 最小限のイベントのみで、完全な監査証跡の要件を満たしません
- **All Events**: すべてのイベントを収集しますが、大量のデータとコストが発生し、「コストを最小限に抑える」要件に反します

### **問題6**
Microsoft Defender for Endpoint の要件を満たすために、CLIENT1 で実行されているクラウドアプリを制限する必要があります。  
変更する必要がある 2 つの構成はどれですか？ 正解はそれぞれソリューションの一部です。  
注：正解は 1 点です  

- A. Microsoft Defender セキュリティ センターのデバイス管理からのオンボーディング設定
- B. Cloud App Security 異常検出ポリシー
- C. Microsoft Defender セキュリティ センターの設定から高度な機能を選択する
- D. Cloud App SecurityのCloud Discovery設定

**正解：C と D**

**理由：**
1. **C. Microsoft Defender セキュリティ センターの設定から高度な機能を選択する**
    - Microsoft Defender for EndpointとCloud App Securityの統合を有効にするには、Microsoft Defender セキュリティ センター（現在のMicrosoft Defender ポータル）の設定で「高度な機能」からCloud App Security統合を有効にする必要があります。
2. **D. Cloud App SecurityのCloud Discovery設定**
    - Cloud App Securityで未承認アプリを定義し、それらをブロックするためには、Cloud Discovery設定でアプリをマークし、ブロックポリシーを構成する必要があります。

**統合の仕組み：**
- Microsoft Defender for EndpointとCloud App Securityを統合することで、Cloud App Securityで「未承認」とマークされたアプリへのアクセスを、Windows 10デバイス上でブロックできます
- この機能により、エンドポイントレベルでクラウドアプリの使用を制御できます

### **問題7**
Azure Sentinelの要件を満たすには、イベントにメモを追加する必要があります。  
どの3つのアクションを順番に実行する必要がありますか？回答するには、適切なアクションをアクションリストから回答領域に移動し、正しい順序に並べます。
![[Pasted image 20260210013558.png]]

**正しい順序：**
1. **From the Azure Sentinel workspace, run a Log Analytics query.** （Azure Sentinelワークスペースから、Log Analyticsクエリを実行する）
2. **Select a query result.** （クエリ結果を選択する）
3. **Add a bookmark and map an entity.** （ブックマークを追加してエンティティをマップする）

**理由：**
- まず、Azure SentinelワークスペースでLog Analyticsクエリを実行して、特定のIPアドレスからのデータアクセスを検索します
- 次に、興味のあるクエリ結果（特定のIPアドレスに関連するイベント）を選択します
- 最後に、選択した結果にブックマークを追加し、IPアドレスなどのエンティティをマップします。これにより、ハンティング中に調査グラフ内でこの情報を参照できるようになります

「Add the query to favorites」と「From Azure Monitor, run a Log Analytics query」は、この要件を満たすための必須手順ではありません。Azure Sentinelのハンティング機能では、ワークスペースから直接クエリを実行し、結果にブックマークを追加することで、後で調査グラフで参照できるようにします。

### **問題8**
Azure Sentinelの要件を満たすには、Azure Sentinel統合を構成する必要があります。  
どうすればよいですか？回答するには、回答エリアで適切なオプションを選択してください。  
注：正しい選択ごとに1ポイント獲得できます。
![[Pasted image 20260210013850.png]]

**正解：**
**In the Cloud App Security portal:**
- **Configure app connectors**

**From Azure Sentinel in the Azure portal:**
- **Add a data connector**

**理由：**
1. **Cloud App Security側（Configure app connectors）：**
    - Cloud App Securityでアプリコネクタを構成することで、様々なクラウドアプリケーションからのデータを収集できます
    - ただし、Azure Sentinelとの統合においては、主にAzure Sentinel側からデータコネクタを追加する方法が一般的です
2. **Azure Sentinel側（Add a data connector）：**
    - Azure Sentinelで「Microsoft Defender for Cloud Apps」（旧Cloud App Security）データコネクタを追加します
    - これにより、Cloud App SecurityのアラートとCloud DiscoveryログをAzure Sentinelに取り込むことができます
    - データコネクタの構成により、Cloud App Securityからのセキュリティアラートやイベントを一元的に管理・分析できます

**不正解の選択肢：**
- **Add a security extension**: セキュリティ拡張機能は統合に直接必要ではありません
- **Configure log collectors**: ログコレクターは主にCloud Discoveryのためのものです
- **Add a workbook**: ワークブックは可視化のためであり、統合の必須要件ではありません
- **Configure the Logs settings**: ログ設定は統合の主要な手順ではありません

### **問題9**
Azure Sentinel の要件とビジネス要件を満たすために、admin1 にロールベースのアクセス制御 (RBAC) ロールを割り当てる必要があります。  
どのロールを割り当てる必要がありますか？  

- A. 自動化オペレーター
- B. 自動化ランブックオペレーター
- C. Azure Sentinel コントリビューター
- D. Azure Sentinel Responder

Azure Sentinelの要件を確認すると、「admin1というユーザーがAzure Sentinelプレイブックを構成できるようにする」必要があります。また、ビジネス要件では「可能な限り、最小権限の原則を使用する必要がある」とされています。

Microsoft Learn MCP Serverで、Azure Sentinelのロールとプレイブック管理の権限について確認します。

**正解：C. Azure Sentinel コントリビューター**

**理由：**
1. **プレイブックの構成に必要な権限：**
    - Azure Sentinelのプレイブック（Logic Apps基盤）を**構成**するには、作成、編集、管理する権限が必要です
    - Azure Sentinel Contributorロールは、Azure Sentinelリソースの完全な管理権限を持ち、プレイブックの構成が可能です
2. **他の選択肢が不適切な理由：**
    - **A. 自動化オペレーター（Automation Operator）：** Azure Automationのジョブを開始/停止できますが、Azure Sentinelのプレイブックを構成する権限はありません
    - **B. 自動化ランブックオペレーター（Automation Runbook Operator）：** ランブックのプロパティを読み取り、ジョブを作成できますが、Azure Sentinelのプレイブック構成には不十分です
    - **D. Azure Sentinel Responder：** インシデントの管理（割り当て、却下、調査など）とプレイブックの**実行**は可能ですが、プレイブックの**構成（作成・編集）**はできません
3. **最小権限の原則：**
    - プレイブックを構成するという要件を満たすには、Azure Sentinel Contributorが必要な最小限のロールです
    - より上位のロール（例：Contributor、Owner）も可能ですが、最小権限の原則に反します

### **問題10**
Azure Sentinelの要件を満たすには、どのルール設定を構成する必要がありますか？  

- A. ルールロジックの設定から、抑制をオフにします。
- B. Analytics ルールの詳細から、戦術を構成します。
- C. ルールロジックの設定から、エンティティをマップします。
- D. 分析ルールの詳細から、重大度を構成します。

**正解：C. ルールロジックの設定から、エンティティをマップします。**

**理由：**
1. **要件の分析：**
    - アラートを「テストユーザーアカウントごとに1つのインシデント」としてグループ化する必要があります
    - これは、ユーザーアカウント（エンティティ）に基づいてインシデントをグループ化することを意味します
2. **エンティティマッピングの重要性：**
    - エンティティマッピングを構成することで、クエリ結果からユーザーアカウント、IPアドレス、ホストなどのエンティティを識別できます
    - マッピングされたエンティティは、インシデントのグループ化、調査グラフの作成、エンティティベースの相関分析に使用されます
    - 「ユーザーアカウントごと」にインシデントをグループ化するには、まずユーザーエンティティを正しくマッピングする必要があります
3. **他の選択肢が不適切な理由：**
    - **A. 抑制をオフにする：** 抑制設定は、同じクエリ結果の重複アラート生成を防ぐためのもので、ユーザーごとのグループ化とは関係ありません
    - **B. 戦術を構成：** 戦術（MITRE ATT&CKフレームワーク）は、攻撃の分類に使用されますが、インシデントのグループ化方法には影響しません
    - **D. 重大度を構成：** 重大度はアラートの優先度を示しますが、ユーザーごとのグループ化には関係ありません
4. **インシデントグループ化の仕組み：**
    - エンティティマッピングを構成した後、「インシデント設定」でエンティティに基づいてアラートをグループ化するオプションを選択できます
    - これにより、同じユーザーアカウントに関連するアラートが1つのインシデントにまとめられます

### **問題11**
Azure Sentinelの要件を満たす分析ルールを作成する必要があります。  
どうすればよいですか？回答するには、回答エリアで適切なオプションを選択してください。  
注：正しい選択ごとに1ポイント獲得できます。
![[Pasted image 20260210014433.png]]

**正解：**
**Create the rule of type:**
- **Scheduled**
**Configure the playbook to include:**
- **A trigger**

**理由：**
1. **ルールタイプ - Scheduled（スケジュール済み）：**
    - **カスタムクエリ**に基づいて分析ルールを作成するには、**Scheduled**ルールタイプを使用します
    - Scheduledルールは、KQL（Kusto Query Language）クエリを定期的に実行し、条件に一致した場合にアラート/インシデントを生成します
    - **Fusion**：機械学習ベースの高度な多段階攻撃検出で、カスタムクエリは使用できません
    - **Microsoft incident creation**：他のMicrosoftセキュリティサービス（Defender for Cloud、Microsoft 365 Defenderなど）からインシデントを自動作成するもので、カスタムクエリは使用できません
2. **プレイブック構成 - A trigger（トリガー）：**
    - プレイブックを自動的に実行するには、**トリガー**が必要です
    - Azure Sentinelでは、「Microsoft Sentinel alert」または「Microsoft Sentinel incident」トリガーを使用します
    - このトリガーにより、分析ルールがアラート/インシデントを生成したときに、プレイブック（Logic App）が自動的に起動されます
    - **Diagnostics settings**：診断設定はログの収集に関するもので、プレイブックの自動実行とは無関係です
    - **A service principal**：サービスプリンシパルは認証に使用されますが、プレイブックの自動実行の必須要件ではありません（Logic AppのマネージドIDで対応可能）

**プレイブック自動実行の仕組み：**
1. Scheduledルールがカスタムクエリを実行
2. 条件に一致するとアラート/インシデントを生成
3. プレイブックのトリガーが起動
4. プレイブックのアクションが自動的に実行される