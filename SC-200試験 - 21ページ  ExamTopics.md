質問#77 トピック3

sws1 という Microsoft Sentinel ワークスペースがあります。  
  
ユーザーが異常に多くの Azure AD ユーザーアカウントを作成したことを検出するクエリを作成する必要があります。  
  
クエリはどのように完成させるべきでしょうか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注: 正解は 1 点です。  
  
![](https://img.examtopics.com/sc-200/image197.png)

**正解:** ![](https://img.examtopics.com/sc-200/image431.png)

**解説:**
このクエリの目的は、「異常な行動」と「具体的なアクション（ユーザー作成）」を紐づけることです。

- **BehaviorAnalytics (上段):** このテーブルは Microsoft Sentinel の **UEBA (User and Entity Behavior Analytics)** 機能によって生成されます。`ActivityInsights` という列を保持しており、ユーザーの行動が通常と異なるかどうかのインサイト（例：過去と比較して作成数が多いなど）が含まれています。そのため、最初のフィルター条件に適合します。
    
- **AuditLogs (下段):** Azure AD（現在の Microsoft Entra ID）におけるユーザーの追加、削除、変更などのアクティビティは **AuditLogs** テーブルに記録されます。`ActionType == "Add user"` という条件や、後の工程で `mv-expand TargetResources`（操作対象のリソース情報の展開）を行うため、詳細な監査ログを持つこのテーブルを `join` する必要があります。

質問#78 トピック3

Azure Activity コネクタを使用してトリガーされる Microsoft Sentinel プレイブックがあります。  
  
このプレイブックを使用する新しいニアリア​​ルタイム (NRT) 分析ルールを作成する必要があります。  
  
このルールにはどのような設定が必要ですか？

- A. インシデント自動化設定
- B. クエリルール
- C. エンティティマッピング
- D. アラート自動化設定

**正解：** B [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/21/#)  

**解説:**
Azure Activityコネクタからのイベントに応じてプレイブックをトリガーする「ニアリアルタイム (NRT) 分析ルール」の作成に関する質問です。
**「Query rule (クエリルール)」**: NRT分析ルールは、実質的には頻繁（1分間隔）に実行されるスケジュールされたクエリールールの一種です。ルール作成画面でKQLクエリを定義し、条件に一致した場合にアラート/インシデントを生成します。プレイブックを自動実行するには、このルールの「自動化 (Automation)」設定で自動化ルールを関連付けるか、レガシーな方法では直接プレイブックを指定します。選択肢の中では、NRTルールの核心部分である「クエリルール」が設定対象として最も適切です（あるいは「インシデント自動化設定」とも取れますが、ルール自体の定義としてはクエリが必須です）。
※試験的な文脈では、NRTルールを作成すること自体（クエリ定義）を指している可能性が高いです。

質問#79 トピック3

Microsoft Sentinel データを視覚化し、サードパーティのデータソースを使用してデータを拡充し、侵害の兆候 (IoC) を特定する必要があります。  
  
何を使用すればよいでしょうか？

- A. Microsoft Sentinelのノートブック
- B. クラウドアプリ向け Microsoft Defender
- C. Azure モニター

**正解：** A [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/21/#)  

**解説:**
データの可視化、サードパーティデータによる拡充、IoC特定を行うための高度なツールです。
**「Microsoft Sentinel Notebooks」**: Jupyter Notebooksを使用することで、MSTICPyなどのライブラリを活用し、複数のデータソース（VirusTotalなどのサードパーティ脅威インテリジェンス）からのデータ取得・結合・可視化を柔軟に行うことができます。標準のダッシュボード（Workbook）では難しい複雑な分析や外部API連携に適しています。

質問#80 トピック3

Azure AD データコネクタを含む Microsoft Sentinel ワークスペースがあります。Azure AD 関連のインシデントにブックマークを関連付ける必要があります。  
  
どうすればよいでしょうか？ 回答するには、適切なブレードを正しいタスクにドラッグしてください。各ブレードは 1 回使用することも、複数回使用することも、まったく使用しないこともできます。コンテンツを表示するには、ペイン間の分割バーをドラッグするか、スクロールする必要がある場合があります。  
  
注: 正解を選択するごとに 1 ポイント獲得できます。  
  
![](https://img.examtopics.com/sc-200/image199.png)

**正解:** ![](https://img.examtopics.com/sc-200/image432.png)

**解説:**
- **Logs blade (ログ ブレード)** ブックマークは、クエリの実行結果から特定のレコードを保存するために使用します。**Logs** ブレードで KQL クエリを実行し、結果行を選択して [Add bookmark] をクリックすることでブックマークが作成されます。
    
- **Hunting blade (ハンティング ブレード)** 作成済みのブックマークを管理したり、既存のインシデントに紐付けたりするには、**Hunting** ブレード内の **Bookmarks** タブを使用します。ここで対象のブックマークを選択し、[Add to existing incident] アクションを実行することで関連付けが完了します。

質問#81 トピック3
  
Azureサブスクリプションに、User1というゲストユーザーとworkspace1というMicrosoft Sentinelワークスペースが含まれています。
User1 がworkspace1でMicrosoft Sentinelインシデントをトリアージできるようにする必要があります。このソリューションでは、最小権限の原則を適用する必要があります。User1 にはどのロールを割り当てるべきですか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注：正解は1点です。  
  
![](https://img.examtopics.com/sc-200/image201.png)

**正解:** ![](https://img.examtopics.com/sc-200/image202.png)

**解説:**
- **Azure role: Microsoft Sentinel Responder**
    
    - **理由:** インシデントのトリアージ（インシデントの割り当て、ステータスや重要度の変更、コメントの追加など）を行うために必要な権限をすべて備えています。
        
    - **比較:** 「Contributor」は分析ルールの作成やデータコネクタの構成も可能であり、「Automation Contributor」はプレイブックの管理用であるため、トリアージのみを目的とする場合は **Responder** が最小権限となります。
        
- **Azure AD role: Directory readers**
    
    - **理由:** ゲストユーザーがインシデントに関与するエンティティ（ユーザー情報など）を適切に参照するために、ディレクトリ情報の読み取り権限が必要です。
        
    - **比較:** 「Global reader」でも可能ですが、管理範囲が広すぎるため、最小権限の原則に基づくと **Directory readers** が最適です。「Attribute assignment reader」は特定のカスタムセキュリティ属性を読み取るための特殊なロールであり、一般的なトリアージには適しません。

[!NOTE] ゲストユーザーの場合、Azure AD（Microsoft Entra ID）の外部コラボレーション設定によっては、ディレクトリ読み取りロールを付与しないと、インシデント内のユーザー詳細が表示されない（匿名表示になる）ことがあるため、このロールの割り当ては実務上も重要です。

質問#82 トピック3

Microsoft Sentinel を使用する Azure サブスクリプションがあり、User1 というユーザーが登録されています。User1 が Azure AD のエンティティの行動分析にユーザーおよびエンティティ行動分析 (UEBA) を有効にできるようにする必要があります。このソリューションでは、最小権限の原則を適用する必要があります。User1 にはどのロールを割り当てるべきですか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注: 正解は 1 ポイントです。  
  
![](https://img.examtopics.com/sc-200/image203.png)

**正解:** ![](https://img.examtopics.com/sc-200/image204.png)

**解説:**
UEBA を有効化し、Azure AD（Microsoft Entra ID）のデータを同期・分析の対象として構成するには、以下の権限セットが必要です。

1. **Azure AD role: Security administrator (セキュリティ管理者)**
    
    - **理由:** UEBA を有効にする際、Azure AD からユーザーデータを同期するためのディレクトリレベルのアクセス許可が必要です。**Global administrator** でも可能ですが、最小権限の原則に基づくと **Security administrator** が最適です。
        
    - **比較:** `Security operator` は表示と対応のみが可能で、構成の変更はできません。
        
2. **Azure role: Microsoft Sentinel Contributor**
    
    - **理由:** Microsoft Sentinel 自体の設定（UEBA の有効化ボタンの操作や分析設定の変更）を行うには、Sentinel ワークスペースに対する書き込み権限を持つ **Microsoft Sentinel Contributor** ロールが必要です。
        
    - **比較:** `Microsoft Sentinel Responder` や `Security Admin`（一般的な Azure ロール）では、Sentinel 固有の機能設定をフルに管理するには不十分な場合があります。
        
---
#### **UEBA 有効化後のメリット**

UEBA を有効にすると、ユーザーの平常時の行動を学習し、以下のような異常を自動的に検知できるようになります。

- **初めて使用される場所からのサインイン**
    
- **通常とは異なる大量のデータ削除やリソース作成**
    
- **横方向への移動（ラテラルムーブメント）の兆候**

質問#83 トピック3
  
次のリソースを含む Azure サブスクリプションがあります。  
  
• Windows Server を実行する VM1 という名前の仮想マシン  
• ユーザーおよびエンティティ行動分析 (UEBA) が有効になっている Sentinel1 という名前の Microsoft Sentinel ワークスペース  
  
VM1 へのサインイン試行を追跡する Rule1 という名前のスケジュールされたクエリ ルールがあります。  
  
会社の IT 部門外のユーザーが VM1 にサインインしたことを検出するには、Rule1 を更新する必要があります。ソリューションは、次の要件を満たしている必要があります。  
  
• UEBA の結果を利用する。  
• クエリのパフォーマンスを最大化する。  
• 誤検知の数を最小限に抑える。  
  
ルール定義をどのように完了する必要がありますか。 回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択ごとに 1 ポイントが付与されます。  
  
![](https://img.examtopics.com/sc-200/image205.png)

**正解:** ![](https://img.examtopics.com/sc-200/image206.png)

**解説:**
- **IdentityInfo (テーブル選択)**
    
    - **理由:** Microsoft Sentinel の **UEBA (User and Entity Behavior Analytics)** 機能を有効にすると、`IdentityInfo` テーブルが作成されます。このテーブルには、Azure AD (Entra ID) から同期されたユーザーのプロファイル情報（名前、**部署 (Department)**、役職など）の最新スナップショットが保持されます。
        
    - **要件の充足:** 「UEBA の結果を利用する」という要件に対し、UEBA によって提供されるエンティティメタデータを使用することで応えています。また、`Department` 情報を取得するのに最も効率的なテーブルです。
        
- **inner (結合の種類)**
    
    - **理由:** `inner join` は、左側（`SecurityEvent`）と右側（`IdentityInfo`）の両方に一致するレコードのみを返します。
        
    - **パフォーマンスと精度:** サインインイベントが発生したユーザーのうち、ID 情報が特定でき、かつその部署が "IT" ではないものだけに絞り込むため、処理対象のデータ量が削減され、クエリのパフォーマンスが最大化されます。また、ID 情報がないノイズを排除できるため、誤検知の抑制にもつながります。
