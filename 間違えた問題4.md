質問4 トピック5

Azure DevOps組織があり、Repo1というAzure Reposリポジトリが含まれており、Microsoft Defender for DevOpsにオンボードされています。Infrastructure as Code (IaC)ファイルを作成し、Repo1に保存します。IaCファイルは、BicepファイルとHelm Chartsとしてフォーマットされています。IaC ファイル内の構成ミスを特定するには、Defender for DevOpsを構成する必要があります。  
  
それぞれのファイルの種類には、どのスキャンツールを使用すべきでしょうか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注：正解は1つにつき1ポイントです。  
  
![](https://img.examtopics.com/sc-200/image246.png)

**解説:**
Defender for DevOps（MSDO）で使用されるIaCスキャンツールです。

1. **Bicep files**: **「Template Analyzer」**。MicrosoftのTemplate Analyzerは、ARMテンプレートおよびBicepファイルのセキュリティ構成ミスをスキャンするために使用されます。
2. **Helm Charts**: **「Terrascan」**。Terrascanは、Terraform, Helm, K8s, DockerfileなどのIaCスキャンをサポートしています。Checkovも有名ですが、MicrosoftのMSDO統合ではTerrascanが採用されています（または両方サポートされていますが、選択肢にある方を選びます）。

質問6 トピック5

オンプレミスデバイスが500台あります。Microsoft Defender 365を利用するMicrosoft 365 E5サブスクリプションを保有しています。Microsoft Defender 365にデバイスを100台オンボードします。管理されていないオンプレミスデバイスを特定する必要があります。オンボードされた特定のデバイスのみが検出を実行するようにソリューションを設定する必要があります。  
  
まず何をすべきでしょうか？

- A. デバイス グループを作成します。
- B. 除外を作成します。
- C. 検出モードを基本に設定します。
- D. タグを作成します。

### 回答: **D. タグを作成します。**

### 詳細な理由

シナリオの要件を整理すると:

- オンプレミスデバイス500台のうち、100台をMicrosoft Defender for Endpointにオンボード
- 管理されていないオンプレミスデバイス（残りの400台）を特定する必要がある
- **オンボードされた特定のデバイスのみ**が検出（Device Discovery）を実行するように設定する

### なぜタグを作成するのが正しいか

Microsoft Defender for Endpointのドキュメントによると:

1. **Device Discoveryの設定方法**:
    - Standard discoveryモードでは、「すべてのオンボードデバイス」または「**デバイスタグで指定したサブセット**」のいずれかを選択できます
    - 公式ドキュメントには明確に記載されています: _"You can customize the list of devices that are used to perform standard discovery. You can either enable standard discovery on all the onboarded devices that also support this capability, or **select a subset of devices by specifying their device tags**"_
2. **実装手順**:
    1. **まず、デバイスタグを作成**（例: "Discovery"タグ）
    2. 検出を実行させたい特定の100台のオンボードデバイスにそのタグを適用
    3. Settings > Device discoveryで、Standard discoveryモードを選択し、「デバイスタグで指定したサブセット」を選択
    4. 作成したタグを指定
3. **結果**:
    - タグが付けられた特定のデバイスのみがアクティブな検出を実行
    - 他のオンボードデバイスは自動的にBasic discoveryモードで動作
    - 管理されていない400台のデバイスがDevice Inventoryで特定される

### 他の選択肢が不適切な理由

- **A. デバイスグループ**: Device Discoveryの設定には使用されません（RBAC用）
- **B. 除外**: これは検出から**除外**するデバイスを指定するもので、検出を実行するデバイスを**選択**するものではありません
- **C. 検出モードを基本に設定**: これでは特定のデバイスのみに制限できず、すべてのデバイスがパッシブ検出のみを行うことになります

**結論**: オンボードされた特定のデバイスのみがアクティブな検出を実行するようにするには、**まずタグを作成**し、それを使用してStandard discoveryを実行するデバイスのサブセットを指定する必要があります。

質問7 トピック5

Microsoft 365 E5 サブスクリプションがあり、Device1 というデバイスが含まれています。Device1 は Microsoft Defender for Endpoint に登録されています。Device1 から、証拠として File1.exe というファイルを含むインシデントが報告されました。  
  
「調査パッケージの収集」アクションを開始し、ZIP ファイルをダウンロードします。File1.exe が最初に実行された時刻と最後に実行された時刻を特定する必要があります。  
  
調査パッケージで確認すべき点は何でしょうか？

- A. プロセス
- B. 自動実行
- C. セキュリティイベントログ
- D. スケジュールされたタスク
- E. プリフェッチファイル

**正解：** E [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/29/#)  

**解説:**
調査パッケージ（Investigation package）に含まれるデータから実行可能ファイルの実行時刻を特定するための情報源です。
**「Prefetch files (プリフェッチファイル)」**: Windowsのプリフェッチファイル（.pf）は、アプリケーションの起動頻度や起動速度を最適化するためのものですが、副次的に「そのアプリケーションが最後に実行された日時」や「実行回数」などの情報が含まれています。調査パッケージにはプリフェッチファイルのダンプが含まれており、これを解析することで、File1.exeの初回/最終実行時刻を特定できます。

質問12 トピック5

Microsoft 365 サブスクリプションをご利用で、Microsoft Defender for Endpoint プラン 2 をご利用で、500 台の Windows デバイスを保有しています。Microsoft Defender XDR のカスタム デセプション ルールを作成する予定です。  
  
このルールが特定の 10 台のデバイスにのみ適用されるようにする必要があります。  
  
まず何をすべきでしょうか？

- A. ルールにカスタムルアーを追加します。
- B. 各デバイスの IP アドレスをルールのデコイ アカウントとホストのリストに追加します。
- C. デバイスをグループに追加します。
- D. デバイスにタグを割り当てます。

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/29/#)  

**解説:**
Defender XDRのデセプション（Deception）ルールを特定のデバイス（10台）のみに適用する方法です。
**「Assign a tag to the devices (デバイスにタグを割り当てる)」**:
デセプションルールのスコープ設定では、**「デバイス タグ (Device Tags)」** を使用して対象をフィルタリングすることができます。デバイスグループも使えますが、特定の少数のデバイスを対象にする場合、タグ付けが柔軟で一般的です。選択肢にデバイスグループがある場合でも、タグが正解となるケースが多いです（詳細な粒度制御のため）。

質問14 トピック5

SW1というMicrosoft Sentinelワークスペースがあります。SW1 で有効になっている異常ルールを特定する必要があります。Microsoft Sentinelで確認すべき項目は何ですか？

- A. コンテンツハブ
- B. エンティティの行動
- C. 分析
- D. 設定

**正解：** C [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/29/#)  

**解説:**
Sentinelで有効になっている「異常（Anomaly）ルール」を確認する場所です。
**「Analytics (分析)」**: 異常ルール（Anomaly rules）は、分析ルールのタブ（Active rulesまたはRule templates）の中に一覧表示されます。ここで有効/無効の状態を確認したり、編集したりできます。「Entity behavior」はUEBAのダッシュボード、「Content hub」はソリューションのインストール場所です。

質問2 トピック6

WS1 という Microsoft Sentinel ワークスペースを含む Azure サブスクリプションがあります。WS1 内のインシデントに、実行する必要があるアクションのリストが含まれていることを確認する必要があります。ソリューションは以下の要件を満たす必要があります。  
  
• インシデントの種類ごとにカスタマイズされたアクションのリストを作成できること。  
• 管理作業を最小限に抑えること。  
  
どうすればよいでしょうか？回答するには、回答エリアから適切なオプションを選択してください。  
  
注: 正しい選択ごとに 1 ポイントが加算されます。  
  
![](https://img.examtopics.com/sc-200/image252.png)

## 回答エリア (Answer Area)

- **Document the actions by configuring:** **Tasks**
- **Build the list of actions by selecting:** **Automated response**

---

## 解説とロジック

### 1. Document the actions by configuring: Tasks

Microsoft Sentinel の **「インシデント タスク (Incident Tasks)」** は、アナリストが調査中に実行すべき手順をリスト化して表示するための専用機能です。

- **Comments** や **Tags** は情報の付加には役立ちますが、手順の進捗管理や「アクションのリスト」としての構造化には向いていません。
- **Tasks** を使用することで、個々のアクションが完了したかどうかをチェックボックス形式で追跡できるようになります。

### 2. Build the list of actions by selecting: Automated response

インシデントの種類に応じて自動的にタスクを追加するには、**「自動応答 (Automated response)」**（オートメーション ルール）を構成します。

- **オートメーション ルール** のアクションとして **「Add task (タスクの追加)」** を選択できます。
- 特定の分析ルール（インシデントの種類）をトリガー条件に設定することで、インシデントが生成された瞬間に、あらかじめ定義したカスタムアクションリストを自動的にインシデントへ紐付けることが可能です。
- これにより、手動で毎回リストを作成する手間が省け、管理作業を最小限に抑えることができます。

質問4 トピック6

AzureサブスクリプションにUser1というユーザーとWS1というMicrosoft Sentinelワークスペースが含まれています。WS1はMicrosoft Defender for Cloudを使用しています。  
  
次の表に示すMicrosoftセキュリティ分析ルールがあります。
  
![](https://img.examtopics.com/sc-200/image275.png)  
  
User1 がRule1、Rule2、Rule3、Rule4に一致するアクションを実行した場合、WS1にはいくつのインシデントが作成されますか？

- A. 1
- B. 2
- C. 3
- D. 4 ​

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/31/#)  

**解説:**
複数の分析ルール（Rule1-4）によって生成されるアラートのグループ化（インシデント統合）設定です。

- Rule1: Low severity, Enabled, Grouping=Disabled -> 1アラートで1インシデント作成（単独）
- Rule2: Medium severity, Enabled, Grouping=Enabled (Group alerts into a single incident if matching entities) -> エンティティ一致でまとまるが、他ルールとの連携設定（Fusionなど）がない限り、Rule2同士でまとまる。
- Rule3, Rule4...
表の詳細（Grouping設定）を見ると、
- Rule 1: Grouping **Disabled**
- Rule 2: Grouping **Disabled**
- Rule 3: Grouping **Disabled**
- Rule 4: Grouping **Disabled**
すべてのルールでグルーピング（Alert grouping）が無効になっています。
したがって、これらのルールがそれぞれトリガーされた場合、各アラートごとに個別のインシデントが作成されます。
User1がRule1, Rule2, Rule3, Rule4に一致するアクションを実行した場合、それぞれのアラートが発生し、それぞれが独立したインシデントになります。
合計 **4つ** のインシデントが作成されます。
※FusionなどのAI相関ルールが働けば別ですが、表の設定（分析ルール設定）だけを見る限り、グルーピング無効なので別々になります。

質問5 トピック6

オンプレミスネットワークがあります。Microsoft Defender for Identity を使用する Microsoft 365 E5 サブスクリプションを所有しています。Microsoft Defender ポータルから、User1 というユーザーの Device1 というデバイスで発生したインシデントを調査します。このインシデントには、次の Defender for Identity アラートが含まれています。  

個人情報盗難の疑い (Pass-the-Ticket) (外部 ID 2018)  
  
ユーザーとデバイスに影響を与えることなく、インシデントを封じ込める必要があります。このソリューションは、管理作業を最小限に抑える必要があります。  
  
どうすればよいでしょうか？

- A. User1 のみを無効にします。
- B. デバイス1のみを隔離します。
- C. 以前デバイス 1 にサインインしたすべてのアカウントのパスワードをリセットします。
- D. User1 を無効にし、Device1 を隔離します。
- E. User1 を無効にし、Device1 を隔離し、以前に Device1 にサインインしたすべてのアカウントのパスワードをリセットします。

### 回答: **C以前デバイス 1 にサインインしたすべてのアカウントのパスワードをリセットします。**

### 理由

**Pass-the-Ticket攻撃の特性:**

- 攻撃者がKerberos チケットを盗み、別のコンピューターで再利用する横展開攻撃
- 盗まれたチケットは、そのチケットの有効期限が切れるまで使用可能
- **パスワードをリセットすると、攻撃者が新しいKerberosチケットを作成できなくなる**

質問8 トピック6
  
Microsoft Defender for Endpoint を使用する Microsoft 365 E5 サブスクリプションがあり、Device1 という Windows デバイスが搭載されています。Device1 で検出された不審な実行ファイルを調査する必要があります。調査には以下の要件を満たす必要があります。  
  
• ファイルのイメージファイルパスを特定する。  
• Device1 でファイルが最初に検出された日時を特定する。  
  
検出イベントのタイムラインから確認すべき点は何ですか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注: 正解は 1 点です。  
  
![](https://img.examtopics.com/sc-200/image280.png)

**解説:**

### 1. イメージ ファイル パスの特定 (Entities)

デバイス タイムライン上のイベントを選択すると、詳細ペインが開きます。

- **Entities（エンティティ）:** このタブには、そのイベントに関与した「ファイル」「プロセス」「ユーザー」などの詳細な属性がリストされます。ファイルの **イメージ ファイル パス（実行場所）** は、このエンティティ情報のメタデータとして明記されています。

### 2. 最初に検出された時刻の特定 (Event entities graph)

- **Event entities graph（イベント エンティティ グラフ）:** このタブは、関連するイベントを時系列の相関図として視覚化します。

- ファイルが作成され、実行され、その後のアクティビティにつながる一連のフローを表示するため、攻撃のチェーンの中で **「いつ、どのアクションが最初のトリガー（最初の検出）となったのか」** を時系列で追跡して特定するのに最適です。

質問16 トピック6

Microsoft 365 E5 サブスクリプションをご利用です。Microsoft Defender for Office 365 では自動調査・対応 (AIR) が有効になっており、デバイスは Microsoft Defender for Endpoint で完全な自動化機能を使用しています。  
  
管理対象デバイスでマルウェアに感染したメールを受信したユーザーに関するインシデントが発生しました。  
  
インシデントを手動で修復する必要があるアクションはどれですか？

- A. メールメッセージをソフト削除する
- B. 電子メールメッセージを強制的に削除する
- C. デバイスの分離
- D. デバイスを含む

**正解：** C [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/32/#)  

**解説:**
Defender for Office 365 (AIR) と Defender for Endpoint (AIR) が連携していますが、手動修復が必要なアクションについてです。
**「Isolate device (デバイスの分離)」**:
メール（ZAP: Zero-hour Auto Purge）やファイル（Quarantine）の修復は「Full automation」設定下では自動的に行われますが、**「デバイスの分離（Isolate device）」** のような重大な影響を及ぼすアクションは、通常、自動調査の結果として提案されても自動実行されず、**承認（Approve）** または手動実行が必要です。管理者が介入して「本当に感染しているため隔離する」と判断する必要があります。
※「Full - remediate threats automatically」レベルでも、デバイス隔離は自動化の対象外（要承認）となるのが一般的です。

質問17 トピック6

Microsoft Defender XDRを使用するMicrosoft 365サブスクリプションがあり、Device1というWindowsデバイスが含まれています。Device1 のタイムラインには、File1.ps1、File2.exe、File3.dllという3つのファイルが含まれています。Microsoft Defender XDRで詳細分析を行うためにファイルを送信する必要があります。  
  
どのファイルを送信できますか？

- A. File1.ps1のみ
- B. File2.exeのみ
- C. File3.dllのみ
- D. File2.exe と File3.dll のみ
- E. File1.ps1 と File2.exe のみ
- F. File1.ps1、File2.exe、およびFile3.dll

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/32/#)  

**解説:**
Defender XDR（MDE）の「Deep Analysis（詳細分析）」に送信可能なファイルタイプです。
Deep Analysisは、ファイルを安全なサンドボックス環境で実行し、その振る舞いを分析する機能です。
サポートされているファイルタイプは **「executable files (.exe, .dll, .sys)」** および **「managed code files (.msi, .jar, etc.)」** ですが、スクリプトファイル（.ps1, .vbs, .batなど）は通常サポートされていません（または自動分析の対象ですがDeep Analysis送信対象外）。
したがって、選択肢の中で送信可能なのは：

- File2.exe (OK)
- File3.dll (OK)
- File1.ps1 (NG - Script)
よって、**File2.exe and File3.dll only (D)** が正解です。

質問18 トピック6

Microsoft Defender XDR を使用する Microsoft 365 サブスクリプションをお持ちです。  
  
インシデントの影響を受けるすべてのエンティティを特定する必要があります。Microsoft  Defender ポータルのどのタブを使用すればよいですか？

- A. 調査
- B. 資産
- C. 証拠と応答
- D. アラート

**正解:**
Microsoft Defender XDRでインシデントの影響を受けるすべてのエンティティを特定するには、**B. 資産(Assets)**タブを使用します。

**理由:**
Assetsタブは、インシデントに関連するすべての資産を1か所で簡単に表示・管理できる統合ビューを提供します。このタブには以下が含まれます:

- **Devices(デバイス)** - インシデントに関連するすべてのデバイス
- **Users(ユーザー)** - インシデントの一部または関連するすべてのユーザー
- **Mailboxes(メールボックス)** - インシデントに関連するすべてのメールボックス
- **Apps(アプリ)** - インシデントに関連するすべてのアプリ
- **Cloud resources(クラウドリソース)** - インシデントに関連するすべてのクラウドリソース

Assetsタブには各カテゴリの資産数が表示され、影響を受けたエンティティの全体像を把握できます。

**他の選択肢について:**

- **調査(Investigations)タブ**: 自動調査の情報を表示
- **証拠と応答(Evidence and Response)タブ**: インシデント内のアラートに含まれる疑わしいイベントとエンティティを表示
- **アラート(Alerts)タブ**: インシデントに関連するアラートのキューを表示

質問#23 トピック6
  
Microsoft Defender XDR と Microsoft Defender for Endpoint を使用する Microsoft 365 サブスクリプションがあります。サブスクリプションには、次の表に示すデバイスが含まれています。  
  
![](https://img.examtopics.com/sc-200/image320.png)  
  
次のフォレンジック データを検出しました。  
  
• デバイス 1 の起動中に、ポート 5555 経由でデバイス 2 への接続が確立されました。  
• デバイス 2 は、ポート 5555 を使用してデバイス 3 に接続します。  
• デバイス 4 は、ポート 5555 を使用してデバイス 1 に接続します。  
  
次のアクションを実行します。  
  
• デバイス 1 でライブ応答セッションを開始し、プロセスを実行します。  
• Microsoft Defender ポータルのデバイスから、デバイス 1 とデバイス 2 を分離します。  
  
次の各ステートメントについて、True の場合は \[はい\] を選択します。それ以外の場合は \[いいえ\] を選択します。  
  
注: 正しい選択ごとに 1 ポイントが与えられます。  
  
![](https://img.examtopics.com/sc-200/image321.png)

**解説:**

#### **1. Device1 will block connections from Device4: [はい]**

- **理由**: Device1 は「分離（Isolated）」されています。デバイスを分離すると、Microsoft Defender for Endpoint サービスとの通信（およびオプションで許可された特定のアプリ）を除き、すべてのインバウンド（受信）およびアウトバウンド（送信）のネットワーク通信がブロックされます。
- **詳細**: Device4 はネットワーク上で検出されただけのオンボードされていないデバイスであり、分離された Device1 への接続は拒否されます。

#### **2. Existing connections from Device2 to Device3 will be maintained: [いいえ]**

- **理由**: デバイスの分離アクションが実行されると、そのデバイスが確立している**既存のすべてのネットワーク接続も即座に切断**されます。
- **詳細**: Device2 が分離された時点で、Device3 へのポート 5555 を使用した既存の接続は維持されず、強制的に終了させられます。

#### **3. The command run in the live response session will identify all the startup processes: [いいえ]**

- **理由**: ライブ応答で一般的に使用される `processes` コマンドなどは、実行した瞬間に**アクティブ（稼働中）であるプロセス**を表示するものです。
- **詳細**: フォレンジックデータにあるように「起動中に実行されたプロセス」であっても、ライブ応答セッションを開始した時点で既に終了しているプロセスについては、標準的なコマンドだけで「すべての起動プロセス」を特定することはできません。起動時（過去）の挙動を調査するには、タイムライン分析や高度な捜索（Advanced Hunting）クエリ、またはイベントログの解析が必要です。

---

**補足:** デバイスを分離しても、Microsoft Defender ポータルからの「ライブ応答（Live Response）」セッションは引き続き可能です。これは、Defender サービスへの通信だけは例外的に許可されているためです。

質問#24 トピック6

Microsoft Defender XDR を使用し、Device1 という名前の Windows デバイスを含む Microsoft 365 E5 サブスクリプションを所有しています。Device1 で悪意のあるアクティビティを検出しました。Device1 でライブ応答セッションを開始しました。  
  
次の操作を実行する必要があります。  
  
• ライブ応答ライブラリからファイルをダウンロードします。  
• Device1 で実行中のプロセスを停止します。  
  
各アクションに対してどのライブ応答コマンドを実行する必要がありますか。回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択はそれぞれ 1 ポイントの価値があります。  
  
![](https://img.examtopics.com/sc-200/image323.png)

### 正解の組み合わせ

1. **Download a file from the live response library (ライブラリからファイルをダウンロード)**: `putfile`
2. **Stop a process that is running on Device1 (実行中のプロセスを停止)**: `remediate`

---

### 解説

ライブ応答セッションでは、デバイスに対して直接調査や操作を行うための専用コマンドが用意されています。

- **putfile**: Microsoft Defender のクラウド上にある「ライブ応答ライブラリ」から、操作対象のデバイス（Device1）にファイルをコピー（ダウンロード）するために使用します。

    > [!NOTE] 逆に、デバイス上のファイルを管理者側の端末へダウンロードしたい場合は `getfile` を使用します。

- **remediate**: 不正なプロセスを停止させたり、悪意のあるファイルを削除したり、サービスを無効化したりするための「修復」コマンドです。特定のプロセスを停止させる場合は `remediate process <process_id>` のように実行します。

---

### その他の選択肢について

- **analyze**: ファイルのエンティティ（ハッシュなど）を分析するために使用します。
- **getfile**: デバイスからファイルを「取り出す」ためのコマンドであり、ライブラリから「入れる」ものではありません。
- **library**: ライブラリに登録されているファイルの一覧を確認するコマンドです。
- **services**: デバイス上のサービス一覧を確認・操作するコマンドです。

質問#28トピック6
  
次の表に示すユーザーを含むAzureサブスクリプションがあります。  
  
![](https://img.examtopics.com/sc-200/image350.png)  
  
サブスクリプションには、次の表に示すAzure Firewallのインスタンスが含まれています。Microsoft Copilot for Securityを使用するMicrosoft 365 E5サブスクリプションがあります。
  
![](https://img.examtopics.com/sc-200/image351.png)  
  
次の表に示すCopilot for Securityロールの割り当てがあります。  
  
![](https://img.examtopics.com/sc-200/image352.png)  
  
各ユーザーはCopilot for Securityセッションを実行します。  
  
次の各文について、正しい場合は「はい」を選択してください。そうでない場合は「いいえ」を選択してください。  
  
注：正しい選択ごとに1点が加算されます  
  
![](https://img.examtopics.com/sc-200/image353.png)

Microsoft Copilot for Security を使用して Azure Firewall から情報を取得（プロンプトによる照会）するには、以下の**すべての要件**を満たす必要があります。

1. **Copilot for Security のロール**: 「オーナー」または「共同作成者」であること（User1, 2, 3 全員が満たしています）。
2. **Azure RBAC ロール**: 対象のリソース（Firewall や Log Analytics ワークスペース）に対する適切な閲覧権限（「閲覧者」や「セキュリティ閲覧者」など）があること。
3. **ログの形式 (Structured Logs)**: Azure Firewall の**「構造化ログ (Structured logs)」**が有効であること。非構造化ログ（従来形式）はサポートされていません。
4. **ログの転送先**: ログが **Log Analytics ワークスペース**に送信されていること。

#### **1. User1 と AFW1 の判定: [いいえ]**

- **権限**: サブスクリプションの「共同作成者」であり十分です。
- **ログ設定**: ログが **「非構造化ログ (Unstructured logs)」** です。
- **理由**: Copilot for Security の Azure Firewall プラグインは、構造化ログを必要とするため、情報を取得できません。

#### **2. User2 と AFW2 の判定: [いいえ]**

- **権限**: サブスクリプションの「共同作成者」であり十分です。
- **ログ設定**: 宛先が **「Azure Event Hubs」** です。
- **理由**: Copilot for Security は Log Analytics ワークスペースに保存されたデータをクエリします。Event Hubs はサポート対象外の宛先であるため、情報を取得できません。

#### **3. User3 と AFW3 の判定: [はい]**

- **権限**: リソースグループの「セキュリティ閲覧者」であり、対象リソースの情報を読み取るのに十分な権限です。
- **ログ設定**: **「構造化ログ (Structured IDPS logs)」** かつ **「Log Analytics」** が宛先となっています。
- **理由**: すべての要件（構造化ログ、サポートされた宛先、適切な権限）を満たしているため、プロンプトを使用して情報を取得できます。

質問#33 トピック6

次の表に示すリソースを含む、Sub1 という Azure サブスクリプションがあります。  
  
![](https://img.examtopics.com/sc-200/image384.png)  
  
インシデント発生時に Lapp1 をトリガーするように Rule1 を構成する予定です。WS1 に割り当てるロールベース アクセス制御 (RBAC) ロールと、そのロールを割り当てるスコープを推奨する必要があります。ソリューションは最小権限の原則に従う必要があります。  
  
どのようなロールを推奨すべきでしょうか？回答するには、回答エリアから適切なオプションを選択してください。  
  
注: 正しい選択肢は 1 つにつき 1 ポイント付与されます。  
  
![](https://img.examtopics.com/sc-200/image385.png)

**解説:**
Microsoft Sentinel の分析ルール（Rule1）から Logic App（LApp1）を自動的に実行（トリガー）させるためには、Sentinel のサービス identity に対して、対象のプレイブックを実行するための適切な権限を与える必要があります。

- **Microsoft Sentinel Playbook Operator ロールの選択理由:** このロールは、Microsoft Sentinel がプレイブック（Logic App）を表示し、実行するために特別に設計されたロールです。`Logic App Operator` よりもプレイブックの運用に特化しており、`Microsoft Sentinel Automation Contributor`（自動化ルールの作成・編集権限）よりも権限が限定されているため、**最小権限の原則**に合致しています。

- **RG2 スコープの選択理由:** LApp1 はリソースグループ **RG2** に配置されています。Sentinel がプレイブックを呼び出す際、通常はプレイブックが格納されているリソースグループ全体に対して「Playbook Operator」権限を付与することが Microsoft の標準的な構成手順です。これにより、Sentinel はそのグループ内のプレイブックを正しく認識し、実行できるようになります。

  - `Sub1` (サブスクリプション) では広すぎます。
  - `RG1` は Sentinel ワークスペース自体の場所であり、実行対象の LApp1 は含まれていません。
  - 特定の `LApp1` 単体に付与することも技術的には可能ですが、Sentinel の UI 上でプレイブックを一覧から選択・管理するためには、リソースグループ単位（RG2）で権限を付与するのが一般的かつ推奨される「最小限の管理作業」を伴う構成です。

質問#34 トピック6

Microsoft Defender for Endpoint にオンボードされている、オンプレミスの Windows 11 Pro デバイス（Device1）があります。Microsoft 365 サブスクリプションを所有しています。Device1 で実行されているプロセスと、プロセスが開いているネットワーク接続を特定する必要があります。このソリューションは、管理作業を最小限に抑える必要があります。Microsoft Defender ポータルで、どの 4 つのアクションを順番に実行する必要がありますか？ 回答するには、アクション一覧から該当するアクションを回答領域に移動し、正しい順序に並べ替えてください。  
  
![](https://img.examtopics.com/sc-200/image387.png)

### 正解のアクション順序

1. **Navigate to the device page for Device1.** (Device1 のデバイス ページに移動する)
2. **Collect an investigation package.** (調査パッケージを収集する)
3. **From the Action center, invoke an action.** (アクション センターから、アクションを呼び出す)
4. **Extract the contents of the ZIP file.** (ZIP ファイルの内容を展開する)

---

### 解説

このソリューションでは、Microsoft Defender for Endpoint の **「調査パッケージ（Investigation Package）」** 機能を活用します。

- **調査パッケージを収集する理由**: この機能を一度実行するだけで、実行中のプロセス、確立されたネットワーク接続、自動開始プログラム、サービス一覧、最近のイベントログなど、フォレンジック調査に必要な情報がすべて一つの ZIP ファイルにまとめられます。個別にコマンドを打つ必要がないため、「管理作業の最小化」という要件に最適です。

- **アクションセンターの役割**: 「調査パッケージの収集」はバックグラウンドで行われます。収集が完了すると、Microsoft Defender ポータルの **「アクション センター（Action center）」** に履歴として残り、そこから成果物（ZIP ファイル）をダウンロードするアクションを実行できます。

- **ZIP ファイルの展開**: ダウンロードしたパッケージを展開すると、`Processes.txt` や `NetworkConnections.txt`（または同様の形式）のファイルが含まれており、そこから目的の情報を確認できます。

質問#35 トピック6
  
次の表に示すAzureサブスクリプションを所有しています。  
  
![](https://img.examtopics.com/sc-200/image389.png)  
  
次の表に示すユーザーを含むMicrosoft Entraテナントを所有しています。  
  
![](https://img.examtopics.com/sc-200/image390.png)  
  
ユーザーには、次の表に示すAzureロールが割り当てられています。Microsoft  
  
![](https://img.examtopics.com/sc-200/image391.png)  
  
Copilot for Securityのキャパシティは、次の表に示すように構成されています。  
  
![](https://img.examtopics.com/sc-200/image392.png)  
  
以下の各項目について、該当する場合は「はい」を選択してください。そうでない場合は「いいえ」を選択してください。  
  
注：正解は1点です。  
  
![](https://img.examtopics.com/sc-200/image393.png)

#### **1. User1 can add an additional capacity to Capacity1: [はい]**

- **Azure 権限**: User1 は **Sub1** の **「所有者 (Owner)」** です。
- **リソースの場所**: **Capacity1** は Sub1 配下の **RG1** にあります。
- **理由**: Copilot for Security のキャパシティ（SCU）を管理（追加・増減）するには、その Azure リソースに対する「所有者」または「共同作成者」の権限が必要です。User1 はサブスクリプション レベルでこの権限を持っているため、Capacity1 を管理できます。

#### **2. User2 can view the capacity usage information of Capacity2: [はい]**

- **Azure 権限**: User2 は **Sub2** の **「閲覧者 (Reader)」** です。
- **リソースの場所**: **Capacity2** は Sub2 配下の **RG3** にあります。
- **理由**: Azure の「閲覧者」権限があれば、リソースの構成やメトリック（使用状況の情報）を表示することができます。User2 は Sub2 全体の閲覧権限を持っているため、その中にある Capacity2 の情報も確認可能です。

#### **3. User3 can configure additional plugins in Capacity2: [いいえ]**

- **Azure 権限**: User3 は **RG2** の **「所有者 (Owner)」** です。
- **リソースの場所**: **Capacity2** は **RG3** にあります。
- **理由**: User3 が持つ Azure の権限は RG2 に限定されており、**RG3 にある Capacity2 に対しては権限がありません**。
- **製品仕様の補足**: User3 は「グローバル管理者」であるため、Copilot for Security のアプリ内では「Copilot オーナー」としてプラグインを構成する権限を（理論上は）持っていますが、この設問の文脈（特定のキャパシティリソースのスコープ）や、Azure RBAC の境界（RG2 vs RG3）を問う形式では、権限の不一致により **「いいえ」** と判定されるのが一般的です。また、プラグインはテナント全体で構成するものであり、特定の「キャパシティの中」で個別に構成するものではないため、文言的にも不適切です。

質問#37 トピック6
  
Microsoft 365 E5 サブスクリプションがあり、Site1 という Microsoft SharePoint Online サイトが含まれています。
Site1 で、次の表に示す不審なファイルを特定します。
  
![](https://img.examtopics.com/sc-200/image397.png)  
  
Microsoft Purview で、次の表に示すコンテンツ検索を作成します。  
  
![](https://img.examtopics.com/sc-200/image398.png)  
  
以下の各記述について、正しい場合は「はい」を選択してください。そうでない場合は「いいえ」を選択してください。  
  
注: 正しい選択はそれぞれ 1 ポイントです。  
  
![](https://img.examtopics.com/sc-200/image399.png)

#### **1. Search1 will return File1.docx: [はい]**

- **クエリ:** `(c:c)(-ItemClass=IPM.Document)(FileName=File1.docx)`

- **条件判定**:

  - `FileName=File1.docx`: 対象のファイル名と完全に一致します。
  - `-ItemClass=IPM.Document`: ここでの `-` は「否定（NOT）」を意味します。`IPM.Document` は通常、Exchange（Outlook）のメッセージクラスであり、SharePoint 上のドキュメントにはこの属性は付与されません。

- **結論**: ファイル名が一致し、かつ排除条件（メールアイテムではないこと）にも合致するため、File1.docx は検索結果に表示されます。

#### **2. Search2 will return File2.docx: [いいえ]**

- **クエリ:** `(c:c)(filetype=doc)(author=User2@contoso.com)`

- **条件判定**:

  - `author=User2@contoso.com`: 作成者は一致します（大文字小文字は区別されません）。
  - `filetype=doc`: **ここがポイントです。** * **結論**: Microsoft Purview や SharePoint の検索において、`filetype` プロパティは拡張子と厳密に照合されます。`.doc`（旧形式）と `.docx`（現在の形式）は**異なるファイルタイプ**として扱われるため、拡張子が `.docx` である File2.docx はこのクエリではヒットしません。

#### **3. Search3 will return File3.docx: [いいえ]**

- **クエリ:** `(c:c)(contenttype:item document)(author=User3@contoso.com)`

- **条件判定**:

  - `author=User3@contoso.com`: 作成者は一致します。
  - `contenttype:item document`: SharePoint における標準的なドキュメントのコンテンツタイプ（ContentType）は、単一の単語で **「Document」** です。

- **結論**: 「item document」という名称のコンテンツタイプは標準では存在せず、クエリがこの特定のフレーズを検索している場合、標準の「Document」属性を持つ File3.docx は一致しないと判定されます。

質問#45 トピック6

Microsoft Defender XDR を使用する Microsoft 365 サブスクリプションがあります。Microsoft Security Copilot を使用する Azure サブスクリプションがあります。Security Copilot で、インシデント ID に関する次の情報を収集するカスタム プロンプトブックを作成する必要があります。  
  
• インシデントの概要  
• 特定された脅威アクターに関する脅威インテリジェンス  
• インシデントの影響を受けたユーザーの詳細な分析  
• インシデントの影響を受けたデバイスの詳細な分析  
  
順番に実行する必要がある 4 つのアクションはどれですか。回答するには、適切なアクションをアクション リストから回答領域に移動し、正しい順序で並べ替えます。  
  
![](https://img.examtopics.com/sc-200/image468.png)

## 回答エリア (Answer Area)

1. **From the Security Copilot standalone portal, create a session.**
2. **Enter the four prompts and gather the required information about a sample incident.**
3. **Select the prompts to include in the promptbook.**
4. **Create the promptbook.**

---

## 解説

プロンプトブックを作成する際のロジックは以下の通りです。

### 1. スタンドアロンポータルでのセッション開始

カスタムプロンプトブックの作成（既存の履歴からの作成）は、**Security Copilot スタンドアロンポータル**で行います。Defender XDRポータルの埋め込みパネルではなく、フル機能が使える専用ポータルを使用するのが第一歩です。

### 2. プロンプトの実行と情報収集

プロンプトブックの「材料」となるプロンプトを実際に実行します。今回の要件では「概要」「脅威インテリジェンス」「ユーザー分析」「デバイス分析」の4つの情報を求めているため、これに対応する**4つのプロンプトを入力**し、サンプルインシデントに対して意図した結果が得られるかを確認します。

### 3. プロンプトの選択

セッションの履歴の中から、プロンプトブックに組み込みたい特定のプロンプト（先ほど実行した4つ）を**選択**します。これにより、一連の流れをテンプレート化する準備が整います。

### 4. プロンプトブックの作成

選択したプロンプトを元に、名前や説明を付けて**プロンプトブックとして保存（Create）**します。これで、次回以降はインシデントIDを入力するだけで、定義した4つのステップが自動的に実行されるようになります。
