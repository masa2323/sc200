概要 -  
  
Fabrikam, Inc. は金融サービス会社です。  
  
この会社には、ニューヨーク、ロンドン、シンガポールに支社があります。Fabrikam には、世界中にリモート ユーザーがいます。リモート ユーザーは、支社への VPN 接続を使用して、クラウド リソースを含む会社のリソースにアクセスします。  
  
既存の環境 -  
  
ID 環境 -  
  
ネットワークには、fabrikam.com という名前の Azure AD テナントと同期する fabrikam.com という名前の Active Directory ドメイン サービス (AD DS) フォレストが含まれています。フォレストを同期するために、Fabrikam は、パススルー認証が有効でパスワード ハッシュ同期が無効な Azure AD Connect を使用します。fabrikam.com フォレストには、Group1 と Group2 という 2 つのグローバル グループが含まれています。

Microsoft 365 環境 -  
  
Fabrikam のすべてのユーザーには、Microsoft 365 E5 ライセンスと Azure Active Directory Premium Plan 2 ライセンスが割り当てられています。  
  
Fabrikam は Microsoft Defender for Identity と Microsoft Defender for Cloud Apps を実装し、ログコレクターを有効にしています。

Azure 環境 -  
  
Fabrikam は、次の表に示すリソースを含む Azure サブスクリプションを保有しています。Amazon Web Services (AWS) 環境  
  
![](https://img.examtopics.com/sc-200/image172.png)  

Fabrikam には Account1 という名前の Amazon Web Services (AWS) アカウントがあります。Account1 には、カスタム Windows Server 2022 を実行する 100 個の Amazon Elastic Compute Cloud (EC2) インスタンスが含まれています。イメージには Microsoft SQL Server 2019 が含まれていますが、エージェントはインストールされていません。  
  
現在の問題 -  
  
ユーザーが VPN 接続を使用すると、Microsoft 365 Defender によって、誤検知であるあり得ない移動アラートが大量に生成されます。Defender for Identity によって、誤検知である DCSync 攻撃の疑いアラートが大量に生成されます。  
  
要件 -  
  
計画されている変更 -  
  
Fabrikam では、次のサービスを実装する予定です。  
  
• Microsoft Defender for Cloud  
• Microsoft Sentinel  
  
ビジネス要件 -  
  
Fabrikam では、次のビジネス要件を特定しています。  
  
• 可能な限り、最小権限の原則を使用します。  
• 管理の労力を最小限に抑えます。  
  
Microsoft Defender for Cloud Apps の要件  
  
Fabrikam では、次の Microsoft Defender for Cloud Apps の要件を特定しています。  
  
• あり得ない移動アラート ポリシーが各ユーザーの以前のアクティビティに基づいていることを確認します。  
• 誤検知であるあり得ない移動アラートの量を減らします。  
  
Microsoft Defender for Identity の要件  
  
誤検知アラートを調査するために必要な管理作業を最小限に抑えます。  
  
Microsoft Defender for Cloud の要件  
  
Fabrikam では、次の Microsoft Defender for Cloud の要件を特定しています。  
  
• Group2 のメンバーがセキュリティ ポリシーを変更できること  
を確認します。
• Group1 のメンバーが、Azure サブスクリプション レベルで規制コンプライアンス ポリシー イニシアチブを割り当てることができることを確認します。  
• Account1 の既存および将来のリソースへの Azure Arc 対応サーバー用の Azure Connected Machine エージェントの展開を自動化します。  
• 誤検知アラートを調査するために必要な管理作業を最小限に抑えます。  
  
Microsoft Sentinel の要件 -  
  
Fabrikam では、次の Microsoft Sentinel の要件を特定しています。
• 組み込みの Advanced Security Information Model (ASIM) 統合パーサーを使用して、過去 7 日間のNXDOMAIN DNS 要求をクエリします。
• AWS EC2 インスタンスから、ローカル グループ メンバーシップの変更を含む Windows セキュリティ イベント ログ エントリを収集します。 
• ユーザーおよびエンティティの動作分析 (UEBA) を使用して、Azure AD ユーザーの異常なアクティビティを特定します  
• App1 が Microsoft Sentinel 自動化ルールで使用できることを確認します。  
• 過去 30 日間に生成されたインシデントのトリアージにかかる平均時間を特定します。  
• 過去 30 日間に生成されたインシデントのクローズにかかる平均時間を特定します。  
• Group1のメンバーがプレイブックを作成および実行できることを確認します。  
• Group1のメンバーが分析ルールを管理できることを確認します。  
• Jupyter Notebookを使用して、Pool1でハンティングクエリを実行します。  
• Group2のメンバーがインシデントを管理できることを確認します。  
• データクエリのパフォーマンスを最大化します。  
• 収集されるデータの量を最小限に抑えます。

### **問題1**
Microsoft Defender for Identityの誤検知アラートを調査するために必要な労力を最小限に抑える必要があります。  
  
何を確認する必要がありますか？

- A. ステータス更新時間
- B. ソースコンピュータの解決方法
- C. アラートステータス
- D. ソースコンピュータの確実性

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/5/#)  

**解説:**
Microsoft Defender for Identity での誤検知（False Positive）を減らし、調査の労力を最小限に抑えるには、アラートのコンテキスト情報、特に **「ソースコンピュータの確実性 (Source computer certainty)」** を確認することが重要です。
DCSync攻撃などのアラートでは、攻撃元が特定できているかどうかが信頼性に大きく関わります。確実性が低い場合、それはネットワークマッピングの問題や一時的な情報の欠落による誤検知の可能性があります。

### **問題2**
Microsoft Defender for Cloud Apps の要件を満たす必要があります。  
  
何をすればよいですか。 回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択ごとに 1 ポイントが付与されます。  
  
![](https://img.examtopics.com/sc-200/image173.png)

**解説:**
1. 感度レベルの設定 (Medium)

Microsoft Defender for Cloud Apps の「あり得ない移動（Impossible travel）」ポリシーでは、感度レベルによって検知の基準が変わります。

- **Low:** 非常に高い信頼度のアラートのみを生成します。
- **Medium:** **各ユーザーの過去のアクティビティ（行動パターン）**に基づいたベースラインと比較してアラートを生成します。設問の「各ユーザーの以前のアクティビティに基づいていることを確認する」という要件には、この Medium が適しています。
- **High:** 物理的に不可能な移動であれば、過去のパターンに関わらずより広範に検知します。
    

2. 誤検知の削減 (Add IP address ranges)

「あり得ない移動」の誤検知は、社内 VPN や特定の拠点のグローバル IP アドレスからアクセスした場合に、地理的に離れた場所からのアクセスとして認識されることで発生しやすくなります。

- **IP アドレス範囲の追加:** 信頼できる組織の IP アドレス範囲（企業のプロキシや VPN など）をシステムに登録することで、それらの既知の場所からのアクセスを考慮に入れ、誤検知を大幅に減らすことができます。
- 漏洩した資格情報の検出（Leaked credential detection）の設定は、別のポリシー（侵害されたアカウントの検知）に関するものであり、移動アラートの誤検知削減には直接関係しません。

### **問題3**
Microsoft Defender for Cloud の要件とビジネス要件を満たすには、Group1 と Group2 にロールベースのアクセス制御 (RBAC) ロールを割り当てる必要があります。  
  
各グループにはどのロールを割り当てる必要がありますか。 回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択ごとに 1 ポイントが付与されます。  
  
![](https://img.examtopics.com/sc-200/image175.png)

**Correct Answer:** ![](https://img.examtopics.com/sc-200/image421.png)

**解説:**
Fabrikamの要件（Group2: ポリシー変更、Group1: イニシアチブ割り当て）を満たす最小権限のロール割り当てです。

1. **Group1 (Assign regulatory compliance policy initiatives)**: **「Resource Policy Contributor (リソース ポリシーの貢献者)」** (またはOwner/Contributor)。イニシアチブ（ポリシーセット）の割り当てには、`Microsoft.Authorization/policyAssignments/write` 権限が必要です。Resource Policy Contributorはこの操作に特化したロールです。Security Adminでは割り当てまではできない場合があります。
2. **Group2 (Modify security policies)**: **「Security Admin (セキュリティ管理者)」**。Defender for Cloud内のセキュリティポリシー設定の変更には、Security Adminロールが最適かつ最小権限です。

### **問題4**
Microsoft Defender for Cloudの要件を満たすには、アカウント1にネイティブクラウドコネクタを展開する必要があります。  
  
アカウント1でまず何をすべきでしょうか？

- A. Defender for Cloud 用の AWS ユーザーを作成します。
- B. AWS Security Hub を設定します。
- C. AWS Systems Manager (SSM) エージェントをデプロイします。
- D. Defender for Cloud のアクセス制御 (IAM) ロールを作成します。

**Correct Answer:** B [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/12/#)  

**解説:**
AWSアカウント（Account1）にネイティブクラウドコネクタを展開する際、AWS側で最初に行うべき設定です。
**「Configure AWS Security Hub (AWS Security Hubを設定します)」**: Defender for Cloudのネイティブコネクタ（CSPM機能など）は、AWS Security Hubからのデータ収集に依存する場合や、統合の一部として連携します。また、コネクタ作成時にAWS側でIAMロールを作成しますが、推奨事項やセキュリティ基準の評価を行うためにSecurity Hubの有効化が前提または推奨されるステップとなります。
（※注：最新のコネクタ（エージェントレススキャン等）ではSecurity Hubが必須でない場合もありますが、従来の構成や試験の文脈ではSecurity Hubとの連携がキーポイントになることが多いです。または純粋にIAMロール作成が最初のステップですが、選択肢の中でAWSサービス側の準備としてはSecurity Hubが該当します。）

### **問題5**
Microsoft Sentinel の要件とビジネス要件を満たすには、Group1 と Group2 にロールベースのアクセス制御 (RBAC) ロールを割り当てる必要があります。  
  
各グループにはどのロールを割り当てる必要がありますか。 回答するには、適切なロールを正しいグループにドラッグします。各ロールは、1 回、複数回、またはまったく使用しない場合があります。コンテンツを表示するには、ペイン間の分割バーをドラッグするか、スクロールする必要がある場合があります。  
  
注: 正しい選択ごとに 1 ポイントが付与されます。  
  
![](https://img.examtopics.com/sc-200/image177.png)

**解説:**
最小権限の原則（Least Privilege）とビジネス要件を考慮し、要件を以下のようにマッピングします。
#### Group1 (管理者・エンジニア層)

Group1 には、Sentinel の構成管理とプレイブックの作成権限が必要です。

- **Microsoft Sentinel Contributor:** 「分析ルールを管理できる (manage analytics rules)」という要件を満たすために必要です。Responder ロールではルールの管理はできません。
- **Logic App Contributor:** 「プレイブックを作成して実行できる (create and run playbooks)」という要件を満たすために必要です。Sentinel のプレイブックは Azure Logic Apps であるため、Logic App レベルでの作成権限（Contributor）が必要です。
    
    - _注: Microsoft Sentinel Playbook Operator は、自動化ルールがプレイブックを実行するために必要な権限ですが、作成者本人には Contributor 権限が必要です。_
        
#### Group2 (オペレーター層)

Group2 は、日々のインシデント対応に特化した権限が求められています。

- **Microsoft Sentinel Responder:** 「インシデントを管理できる (manage incidents)」という要件を満たす最小権限のロールです。Responder はインシデントの割り当て、ステータスの変更、コメントの追加が可能ですが、分析ルールの変更などはできません。
    
---
### その他の要件の補足

- **App1 の自動化ルール利用:** App1 は Logic App であり、Sentinel の自動化ルールから呼び出すには、Sentinel 自体に App1 に対する実行権限（Sentinel Playbook Operator など）が必要になりますが、これはユーザーへのロール割り当てとは別の構成手順となります。
    
- **Pool1 でのハンティング:** Pool1 (Azure Synapse Apache Spark pool) でノートブックを実行する場合、通常は Synapse 側の権限も必要ですが、Sentinel の要件としては Contributor 権限でノートブックの管理が可能です。

### **問題6**
UEBA を使用するためのMicrosoft Sentinelの要件を満たすには、SecurityEvent Log Analyticsテーブルのデータを相関させる必要があります。  
どのLog Analyticsテーブルを使用すればよいですか？

- A. アイデンティティ情報
- B. AADRiskyユーザー
- C. センチネル監査
- D. アイデンティティディレクトリイベント

**正解：** A [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/20/#)  

**解説:**
Microsoft Sentinel の **UEBA (ユーザーおよびエンティティ行動分析)** を効果的に機能させ、要件にある「異常なアクティビティの特定」や「潜在的な影響の評価」を行うには、アクティビティログ（SecurityEvent）とユーザーの属性情報を結びつける必要があります。

#### なぜ IdentityInfo テーブルなのか

- **プロファイルの構築**: `IdentityInfo` テーブルは、Microsoft Entra ID (Azure AD) から同期されたユーザーのプロファイル情報（役職、部署、マネージャー、所属グループなど）を保持します。
    
- **コンテキストの提供**: `SecurityEvent` で検知された特定の動作（例：深夜のログオン）が、そのユーザーの役割（Group1 なのか Group2 なのか）に照らして「異常」かどうかを判断するためのベースラインとして使用されます。
- **影響評価**: 「資格情報が侵害された際の影響」を評価するには、そのユーザーがどのような権限（グループメンバーシップ）を持っているかを知る必要があり、その情報は `IdentityInfo` に格納されています。
    
---
#### 他の選択肢について

- **B. AADRiskyユーザー**: これは Entra ID Protection が検知した「既にリスクがあると判断されたユーザー」のリストであり、UEBA の分析プロファイルを構築するための基礎データ（属性情報）ではありません。
- **C. センチネル監査 (SentinelAudit)**: Sentinel 自体の設定変更などの操作ログであり、ユーザー行動分析には使用しません。
- **D. アイデンティティディレクトリイベント (IdentityDirectoryEvents)**: これは主に Microsoft Defender for Identity からのオンプレミス AD 信号を格納します。重要なデータソースではありますが、UEBA がエンティティを識別・分類するための「名簿（プロファイル）」の役割を果たすのは `IdentityInfo` です。

### **問題7**
App1  はMicrosoft Sentinelの要件を満たす必要があります。App1  にはどのような構成が必要ですか？

- A. トリガー
- B. コネクタ
- C. 認可
- D. API接続

Microsoft Sentinel では、インシデントトリガープレイブック（Logic Apps）を実行するための権限が必要です。インシデントトリガーに基づいてプレイブックを実行するには、手動でも自動化ルールからでも、Microsoft Sentinel はそのために特別に承認されたサービスアカウントを使用します。

#### 解説(参考)
Microsoft Sentinel の **自動化ルール (Automation rules)** からプレイブック（Azure Logic Apps）を呼び出すためには、その Logic App が Sentinel 専用の **トリガー** で開始されるように構成されている必要があります。
#### なぜ「トリガー」が必要なのか

- **ネイティブ統合**: 現在、App1 は「HTTP エンドポイントを使用して呼び出される」構成になっています。しかし、Sentinel の自動化ルールがプレイブックを認識し、インシデント発生時にデータを正しく渡すためには、Logic App の開始コネクタを **「Microsoft Sentinel インシデント（またはアラート）が生成されたとき」** という専用トリガーに変更する必要があります。
    
- **自動化ルールでの選択**: Sentinel の自動化ルール作成画面では、適切な Sentinel トリガーを持つ Logic App のみが「プレイブック」としてドロップダウンリストに表示されます。
- **B. コネクタ (Connector)**: Logic App 内でアクションを実行するためにコネクタは使用されますが、自動化ルールとの「紐付け」自体を決定するのはトリガーです。
- **C. 認可 (Authorization)**: Sentinel がプレイブックを実行するために「Microsoft Sentinel プレイブック オペレーター」ロールなどの権限（認可）が必要ですが、これはリソースに対する **権限設定** であり、App1 自体の **「構成 (Configuration)」** とは通常区別されます。
- **D. API 接続 (API Connection)**: コネクタが外部サービスと通信するための認証情報ですが、Sentinel との連携の要件ではありません。
    
---
> [!TIP] **実務・試験での注意点** 実際に運用する際は、App1 にトリガーを設定するだけでなく、**Microsoft Sentinel 自体に App1 を実行する権限（認可）** を付与することも忘れないでください。試験では「構成」を問われればトリガー、「権限」を問われればロール割り当てが正解になることが多いです。

### **問題8**
Microsoft Sentinelの要件を満たすには、ハンティングクエリを実行できることを確認する必要があります。  
  
どのようなタイプのワークスペースを作成する必要がありますか？

- A. Azure Synapse Analytics
- B. Azure 機械学習
- C. ログ分析
- D. Azure データブリックス

**正解：** B [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/20/#)  

**解説:**
SentinelのHunting Query（特にJupyter Notebooksを使用した高度なハンティング）を実行するために作成する必要があるワークスペースです。
**「Azure Machine Learning」**: Microsoft SentinelのNotebooks機能は、Azure Machine Learningワークスペース上で動作します。そのため、Notebooksを利用して高度な分析やハンティングを行うには、AMLワークスペースの作成とリンクが必要です。
※KQLベースの標準ハンティングならLog Analyticsですが、選択肢にLog Analyticsがない場合や、高度な分析を意図している場合はAzure MLが正解です。

### **問題9**
Microsoft  Sentinelの要件を満たすには、どの平均時間メトリックを使用するかを特定する必要があります。  
  
どのワークブックを使用すればよいでしょうか？

- A. イベントアナライザー
- B. 調査の洞察
- C. セキュリティ運用の効率
- D. 分析の効率

**正解：** C [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/21/#)  

**解説:**
Microsoft Sentinel の要件にある「過去 30 日間の平均トリアージ時間」および「平均クローズ時間」を特定するには、SOC（セキュリティオペレーションセンター）のパフォーマンスを可視化するための専用ワークブックが必要です。

#### なぜ「セキュリティ運用の効率」ワークブックなのか

- **標準メトリクスの提供**: このワークブックは、以下の主要なパフォーマンス指標（KPI）を自動的に算出・表示します。
    
    - **Mean Time to Acknowledge (MTTA)**: インシデントが割り当てられるまでの平均時間。これが要件にある「平均トリアージ時間」に該当します。
    - **Mean Time to Resolve (MTTR)**: インシデントがクローズされるまでの平均時間。これが要件にある「平均クローズ時間」に該当します。
        
- **期間フィルタ**: 「過去 30 日間」といった特定の期間でデータをフィルタリングする機能が組み込まれています。
    
---
#### 他の選択肢について

- **A. イベントアナライザー (Event Analyzer)**: 特定のログソースの量や異常を分析するためのもので、インシデント処理時間の統計には適していません。
    
- **B. 調査の洞察 (Investigation Insights)**: 個別のインシデントやエンティティの相関関係に焦点を当てたものであり、組織全体の効率性を測るものではありません。
    
- **D. 分析の効率 (Analytics Efficiency)**: 分析ルール（検知ルール）の精度や、どのルールが多くのインシデントを生成しているかを分析するためのものであり、対応時間の計測が主目的ではありません。
    
---
> [!TIP] **SC-200 試験のポイント** SOC の管理に関する問題では、「MTTA（トリアージ時間）」と「MTTR（解決・クローズ時間）」という用語が頻出します。これらを視覚化するツールは **「Security Operations Efficiency（セキュリティ運用の効率）」** ワークブックであるとセットで覚えておきましょう。

### **問題10**
DNS 関連のアクティビティを調査するためのクエリを作成する必要があります。ソリューションは、Microsoft Sentinel の要件を満たしている必要があります。  
  
どのようにクエリを完了する必要がありますか? 回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択ごとに 1 ポイントの価値があります。  
  
![](https://img.examtopics.com/sc-200/image179.png)

**解説:**
ASIM (Advanced Security Information Model) 統合パーサーを使用して、過去7日間のNXDOMAIN応答を検索するクエリです。
**`_Im_Dns(starttime=ago(7d), response_code_name='NXDOMAIN')`**: ASIMパーサーは、KQL関数として実装されています（`_Im_Dns`など）。パフォーマンスを最適化するために、フィルタ条件（時間範囲や応答コードなど）を関数のパラメータとして渡すことが推奨されています。これにより、バックグラウンドでのデータ取得が最適化されます。`where`句で後からフィルタするよりも効率的です。

### **問題11**
Windows セキュリティ イベント ログを収集するには、Microsoft Sentinel の要件を満たす必要があります。  
  
何をすればよいですか。 回答するには、回答領域で適切なオプションを選択します。  
  
注: 正しい選択ごとに 1 ポイントの価値があります。  
  
![](https://img.examtopics.com/sc-200/image181.png)

**正解:** ![](https://img.examtopics.com/sc-200/image182.png)

**解説:**
AWS EC2インスタンスからWindowsセキュリティイベントログを収集し、かつ「データ収集量を最小限に抑える（変更イベントのみなど）」という要件を満たす構成です。

1. **Connector type**: **「Windows Security Events via AMA」**。従来のMMAエージェントは廃止予定であり、AWS EC2などの非AzureサーバーにはAzure Arc経由でAMA (Azure Monitor Agent) を使用するのが現在の標準です。
2. **Install the agent on**: **「The EC2 instances」**。各EC2インスタンスにAzure Arcエージェントをインストールし、Azure Monitor Agent拡張機能を展開します。
3. **Define which events to collect by using**: **「A data collection rule (DCR)」**。AMAではDCRを使用して、収集するイベントレベル（Error, Auditなど）や特定のイベントIDを細かく制御できます。これにより不要なログ収集を抑え、コストとパフォーマンスを最適化できます。


