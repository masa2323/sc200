概要 -  
  
Adatum Corporation は、ニューヨーク、シカゴ、サンフランシスコに支社を持つ、米国を拠点とする金融サービス企業です。  
  
既存の環境 -  
  
ID 環境 -  
  
オンプレミス ネットワークには、adatum.com という Azure AD テナントと同期する corp.adatum.com という Active Directory ドメイン サービス (AD DS) フォレストが含まれています。すべてのユーザーとグループの管理タスクは、corp.adatum.com で実行されます。corp.adatum.com ドメインには、adatum.com と同期する Group1 というグループが含まれています。  
  
ライセンスの状態 -  
  
Adatum のすべてのユーザーには、Microsoft 365 ES ライセンスと Azure Active Directory Premium P2 ライセンスが割り当てられています。  
  
クラウド環境 -  
  
クラウド環境には、Microsoft 365 サブスクリプション、adatum.com テナントにリンクされた Azure サブスクリプション、および次の表に示すリソースが含まれています。  
  
![](https://img.examtopics.com/sc-200/image233.png)  
  
オンプレミス環境 -  
  
オンプレミスネットワークには、次の表に示すリソースが含まれています。  
  
![](https://img.examtopics.com/sc-200/image234.png)  
  
要件 -  
  
計画されている変更 -  
  
Adatum は以下の変更を行う予定です。  
  
• 次の KQL クエリを含む、rulequery1 というクエリを実装します。  
  
![](https://img.examtopics.com/sc-200/image235.png)  
  
• rulequery1 に基づいてインシデントを生成する Microsoft Sentinel のスケジュールされたルールを実装します。  
  
Microsoft Defender for Cloud の要件  
  
Adatum では、次の Microsoft Defender for Cloud の要件が識別されています。  
  
• Group1 のメンバーは、Defender for Cloud プランを有効にして、規制コンプライアンス イニシアチブを適用できる必要があります。  
• Microsoft Defender for Servers プラン 2 は、すべての Azure 仮想マシンで有効にする必要があります。  
• Server2 は、エージェントレス スキャンから除外する必要があります。  
  
Microsoft Sentinel の要件 -  
  
Adatum では、次の Microsoft Sentinel の要件が識別されています。  
  
• Infoblox1 からの NXDOMAIN 応答をもたらす DNS 要求の数を返す Advanced Security Information Model (ASIM) クエリを実装します。  
• 1 人のユーザーが Azure Cloud Shell を複数回起動したことに応答して rulequery1 によって生成される複数のアラートが、1 つのインシデントとして統合されるようにします。  
• Microsoft Sentinel の AMA コネクタを介して Windows セキュリティ イベントを実装し、Server1 のセキュリティ イベント ログを監視するように構成します。  
• Azure Cloud Shell が会社の SecOps チームによって起動された場合、rulequery1 によって生成されたインシデントが自動的に閉じられるようにします。  
• Webapp1 からデータを動的に取得するクエリを含む、Workbook1 という名前のカスタム Microsoft Sentinel ブックを実装します。  
• 指定された緊急アカウントへのサインインを検出する Microsoft Sentinel ニアリアルタイム (NRT) 分析ルールを実装します。  
• Azure ポータルで Microsoft Sentinel の Hunting ページにアクセスされたときに、HuntingQuery1 が自動的に実行されるようにします。  
• corp.adatum.com ユーザー アカウントのパスワード リセットが通常よりも多く検出されるようにします。  
• ASIM パーサーを使用するクエリに関連するオーバーヘッドを最小限に抑えます。  
• Group1 のメンバーがプレイブックを作成および編集できるようにします。  
• 可能な限り、組み込みの ASIM パーサーを使用します。ビジネス 要件  
  
\-  
  
### **問題1**
Adatum では、次のビジネス要件が示されています。  
  
• 可能な限り、最小権限の原則に従います。  
• 可能な限り、管理の労力を最小限に抑えます。  
  
- A. Microsoft Antimalware拡張機能
- B. Windows 用の Azure Automanage マシン構成拡張機能
- C. Azureリソースロック
- D. Azureリソースタグ

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/13/#)  

**解説:**
Adatumのビジネス要件「管理の労力を最小限に抑える」および「整理・管理」の観点で最適なAzure機能です。
**「Azureリソースタグ (Azure resource tags)」**: リソースにメタデータ（タグ）を付与することで、コスト管理（部門ごとの課金分析など）やリソースの論理的なグループ化が可能になります。ポリシーでタグ付けを強制すれば、管理負荷を抑えつつ一貫性を保てます。
リソースロック（C）は誤削除防止には有効ですが、コスト管理や柔軟な整理には直接寄与しません。

### **問題2**
Adatum では、次のビジネス要件が示されています。  
  
• 可能な限り、最小権限の原則に従います。  
• 可能な限り、管理の労力を最小限に抑えます。 

- A. セキュリティ評価貢献者
- B. 貢献者
- C. セキュリティ管理者
- D. オーナー

**解説:**
この問題のポイントは、Microsoft Defender for Cloud の管理に必要な権限と、Adatum 社のビジネス要件である「最小権限の原則」を両立させることにあります。

なぜ「セキュリティ管理者」なのか

Microsoft Defender for Cloud において、以下の操作を行うには特定の権限が必要です。

- **Defender プランの有効化:** サブスクリプション レベルでセキュリティ プランを「オン」にする権限。
- **規制コンプライアンス イニシアチブの適用:** セキュリティ ポリシー（Azure Policy イニシアチブ）を編集・割り当てする権限。
    
**セキュリティ管理者 (Security Admin)** ロールは、以下の権限を持っています：

1. セキュリティ ポリシーの表示および**編集**。
2. セキュリティの状態の表示。
3. アラートと推奨事項の表示および破棄。
4. **Defender プランの管理（有効化・無効化）**。
    
これにより、Group1 は必要な管理作業を行うことができます。

他の選択肢が最適ではない理由

- **A. セキュリティ評価貢献者 (Security Assessment Contributor):** 主に特定のセキュリティ評価（脆弱性スキャンなど）の実行や表示に特化したロールであり、サブスクリプション全体のプラン有効化やポリシーの割り当てを行うには権限が不足しています。
- **B. 貢献者 (Contributor):** リソースの作成や管理など、セキュリティ以外の広範な権限も付与されてしまいます。今回の「セキュリティ管理」という特定の目的に対しては、権限が強すぎるため、ビジネス要件である**「最小権限の原則」**に反します。
- **D. オーナー (Owner):** アクセス権の管理（RBAC の設定）を含むすべての操作が可能です。最も権限が強いため、最小権限の原則の観点から真っ先に除外されます。
    
---
この構成により、Group1 は IT 管理に必要な最小限の範囲で、セキュアな環境構築とコンプライアンス維持を担当できるようになります。

### **問題3**
Adatum では、次のビジネス要件が示されています。  
  
• 可能な限り、最小権限の原則に従います。
• 可能な限り、管理の労力を最小限 に抑えます。  
  
- A. カスタム詳細
- B. エンティティマッピング
- C. イベントのグループ化
- D. アラートの詳細

**正解：** B [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/23/#)  

**解説:**
Adatumの要件「1人のユーザーがAzure Cloud Shellを複数回起動した...複数のアラートが、1つのインシデントとして統合されるようにする」を満たすための設定です。
**「Entity mapping (エンティティマッピング)」**: アラートのグループ化（インシデント統合）を行うためには、アラート間で共通するキー（この場合は「User (Account)」）が必要です。分析ルールの設定で「Entity mapping」を定義し、Accountエンティティにユーザー名をマッピングすることで、Sentinelは「同じユーザーによるアラート」であることを認識し、インシデント設定（Incident grouping）に基づいてこれらを1つのインシデントにまとめることができるようになります。

### **問題4**
Adatum では、次のビジネス要件が示されています。  
  
• 可能な限り、最小権限の原則に従います。
• 可能な限り、管理の労力を最小限 に抑えます。  

- A. インシデントトリガーを含むプレイブック
- B. アラートトリガー付きのプレイブック
- C. Azure Automationルール
- D. エンティティトリガーを含むプレイブック

**正解：** A [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/23/#)  

**解説:**
Adatumの要件「App1（自動化ルール）を使用できることを確認する」に関連して、最初に作成すべきリソースです。
**「Playbook with incident trigger (インシデントトリガーを含むプレイブック)」**: Sentinelの自動化ルール (Automation rule) からプレイブックを呼び出すためには、そのプレイブックが **「Microsoft Sentinel Incident」トリガー** を使用して作成されている必要があります（アラートトリガーのプレイブックは、分析ルールから直接呼び出す古い方式で主に使用されますが、新しいAutomation ruleからはインシデントトリガーが標準です）。したがって、まずインシデントトリガーを持つプレイブックを作成する必要があります。

### **問題5**
![](https://img.examtopics.com/sc-200/image236.png)

**正解:** ![](https://img.examtopics.com/sc-200/image434.png)

**解説:**

1. In the identity environment, implement:

**正解：Microsoft Defender for Identity**

- **理由:** 要件に「`corp.adatum.com` ユーザーアカウントのパスワードリセットが通常よりも多く検出されるようにする」とあります。
- **技術的背景:** `corp.adatum.com` はオンプレミスの Active Directory ドメインです。
- **機能:** Microsoft Defender for Identity は、オンプレミスのドメインコントローラーからの信号を解析し、パスワードリセットの急増といった不審なアクティビティや攻撃（ブルートフォース、偵察など）を検出するのに最も適したソリューションです。

1. In Microsoft Sentinel, configure:

**正解：User and Entity Behavior Analytics (UEBA)**

- **理由:** 同じく「パスワードリセットが通常よりも多く検出される（異常検知）」という要件に対応するためです。
- **技術的背景:** ユーザーの「通常」の行動を学習し、そこから逸脱したパターン（異常な頻度のパスワード操作など）を特定するのは UEBA の主要な機能です。
- **最小限の労力:** NRTルールやスケジュール済みルールを手動で細かく調整するよりも、UEBA エンジンによる行動分析を活用する方が、管理の労力を抑えつつ精度の高い検出が可能です。

### **問題6**
![](https://img.examtopics.com/sc-200/image238.png)

**解説:**
この設問には、「**Infoblox1 からの NXDOMAIN 応答を返す ASIM クエリの実装**」および「**ASIM パーサーを使用するクエリのオーバーヘッドを最小限に抑える**」という要件が関係しています。
#### ASIM parser

**正解: _Im_Dns**

- **理由**: Adatum は「可能な限り、組み込みの ASIM パーサーを使用する」方針です。`_Im_Dns` は DNS スキーマ用の**組み込みフィルタリングパーサー**です。特定のソース（Infoblox1）に限定した `_Im_Dns_InfobloxNIOS` よりも、汎用的なフィルタリングパーサーを使用し、パラメータで制御する方が ASIM の設計原則に沿っています。
#### Filter

**正解: A filtering parameter**

- **理由**: 「オーバーヘッドを最小限に抑える」ためには、データをすべて読み込んだ後に `where` 句で絞り込むのではなく、パーサーの実行段階でフィルタリングを行う **Filtering parameter**（フィルタリングパラメータ）を使用するのが最も効率的です。これにより、クエリの実行速度が向上し、リソース消費を抑えられます。

### **問題7**
Server1 のイベント監視を構成する必要があります。  
  
- A. Microsoft Sentinel自動化ルール
- B. Azure Event Gridトピック
- C. Microsoft Sentinel のスケジュールされたクエリ ルール
- D. データ収集ルール（DCR）

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/23/#)  

**解説:**
Adatumの要件「Server1（オンプレミス）のセキュリティイベントログを監視する（AMAコネクタ経由）」に必要な構成要素です。
**「Data collection rule (DCR)」**: Azure Monitor Agent (AMA) を使用してWindowsイベントログを収集するには、DCR（データ収集ルール）を作成し、収集するイベントの種類（System, Security, Applicationなど）とレベル、および対象のリソース（Server1）を定義して関連付ける必要があります。

ソリューションはMicrosoft Sentinelの要件を満たしている必要があります。  
  
クエリをどのように完了すればよいですか？回答するには、回答エリアで適切なオプションを選択してください。  
  
注：正しい選択ごとに1ポイント獲得できます。  
  
![](https://img.examtopics.com/sc-200/image240.png)

**正解:** ![](https://img.examtopics.com/sc-200/image241.png)

**解説:**
この設問は、Microsoft Sentinel の要件である「指定された緊急アカウントへのサインインを検出する Microsoft Sentinel ニアリアルタイム (NRT) 分析ルールを実装する」に基づいています。

---
#### **Answer Area の選択肢と解説**

#### **1つ目のドロップダウン (演算子):**

**正解: join**

- **理由:** `kind=inner` という指定が直後にあるため、文法的に `join` 演算子が必須です。
- **解説:** `lookup` 演算子も同様の照合が可能ですが、`kind=inner` オプションは `join` 演算子で使用される標準的な構文です。緊急用アカウント（ブレイクグラスアカウント）のリストと、実際のサインインログを結合して一致するもののみを抽出します。

#### **2つ目のドロップダウン (データソース):**

**正解: _GetWatchlist**

- **理由:** 「指定された緊急アカウント」を管理し、クエリ内で動的に参照するために最も効率的な方法は **Microsoft Sentinel ウォッチリスト (Watchlist)** を使用することです。
- **解説:** `_GetWatchlist('breakglass_account')` 関数を使用することで、ウォッチリストに登録されたアカウント一覧を右テーブル（$right）として読み込み、`UserPrincipalName` と `SearchKey` で紐付けを行います。これにより、ソースコードに直接アカウント名を書き込む必要がなくなり、管理の労力を最小限に抑えることができます。

### **問題8**
Group1 のメンバーが Microsoft Sentinel の要件を満たせるようにする必要があります。

- A. Microsoft Sentinel Playbook オペレーター
- B. ロジックアプリ貢献者
- C. 自動化オペレーター
- D. Microsoft Sentinel Automation 貢献者

**正解：** B [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/23/#)  
  
**解説**
プレイブックを作成するには、プレイブックを作成するリソース グループの所有者であるか、ロジック アプリの共同作成者ロールを持っている必要があります。

### **問題9**
HuntingQuery1 の構成が Microsoft Sentinel の要件を満たしていることを確認する必要があります。

- A. HuntingQuery1 をライブストリームに追加します。
- B. ウォッチリストを作成します。
- C. Azure Automation ルールを作成します。
- D. HuntingQuery1 をお気に入りに追加します。

**正解：** D [🗳️](https://www.examtopics.com/exams/microsoft/sc-200/view/23/#)  

**解説**
お気に入りに保存されたクエリは、ハンティング ページにアクセスするたびに自動的に実行されます。

### **問題10**
クエリはどのように設定すればよいですか？回答するには、回答エリアで適切なオプションを選択してください。注：正しい選択ごとに1ポイント獲得できます。  
  
![](https://img.examtopics.com/sc-200/image242.png)

**正解:** ![](https://img.examtopics.com/sc-200/image243.png)

**解説:**
「Webapp1 からデータを動的に取得する Workbook1」を実装するための設定です。

- **Data source to query: Custom Endpoint
  - Webapp1は「オンプレミスにある、パブリックに公開されたHTTP/HTTPSウェブサービス」です。Azureのリソース外にある外部ソースからデータを取得する場合、Azure Monitor Workbooksでは **Custom Endpoint データソースを使用します。

- **On Webapp1:** **Enable Cross-Origin Resource Sharing (CORS).**

  - Azure Monitor ブック（Workbook1）などのクライアントサイドのブラウザから外部の Web サービス（Webapp1）に直接リクエストを送信してデータを取得する場合、ブラウザのセキュリティ制限を回避するために Webapp1 側で **CORS** を許可する必要があります。
